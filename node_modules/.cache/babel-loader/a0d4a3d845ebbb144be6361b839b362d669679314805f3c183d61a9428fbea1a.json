{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports._setObjectInStorage = exports._getObjectFromStorage = exports.Storage = void 0;\nconst Log_1 = require(\"./Log\");\nconst SafeJs_1 = require(\"./SafeJs\");\nconst inMemoryStore = {};\nconst _inMemoryProvider = {\n  isReady: () => true,\n  isReadyResolver: () => null,\n  getProviderName: () => 'InMemory',\n  getItem: key => inMemoryStore[key] ? inMemoryStore[key] : null,\n  setItem: (key, value) => {\n    inMemoryStore[key] = value;\n  },\n  removeItem: key => {\n    delete inMemoryStore[key];\n  },\n  getAllKeys: () => Object.keys(inMemoryStore)\n};\nlet _localStorageProvider = null;\ntry {\n  const win = (0, SafeJs_1._getWindowSafe)();\n  if (win && win.localStorage && typeof win.localStorage.getItem === 'function') {\n    _localStorageProvider = {\n      isReady: () => true,\n      isReadyResolver: () => null,\n      getProviderName: () => 'LocalStorage',\n      getItem: key => win.localStorage.getItem(key),\n      setItem: (key, value) => win.localStorage.setItem(key, value),\n      removeItem: key => win.localStorage.removeItem(key),\n      getAllKeys: () => Object.keys(win.localStorage)\n    };\n  }\n} catch (error) {\n  Log_1.Log.warn('Failed to setup localStorageProvider.');\n}\nlet _main = _localStorageProvider !== null && _localStorageProvider !== void 0 ? _localStorageProvider : _inMemoryProvider;\nlet _current = _main;\nfunction _inMemoryBreaker(action) {\n  try {\n    return action();\n  } catch (error) {\n    if (error instanceof Error && error.name === 'SecurityError') {\n      exports.Storage._setProvider(_inMemoryProvider);\n      return null;\n    }\n    throw error;\n  }\n}\nexports.Storage = {\n  isReady: () => _current.isReady(),\n  isReadyResolver: () => _current.isReadyResolver(),\n  getProviderName: () => _current.getProviderName(),\n  getItem: key => _inMemoryBreaker(() => _current.getItem(key)),\n  setItem: (key, value) => _inMemoryBreaker(() => _current.setItem(key, value)),\n  removeItem: key => _current.removeItem(key),\n  getAllKeys: () => _current.getAllKeys(),\n  // StorageProviderManagment\n  _setProvider: newProvider => {\n    _main = newProvider;\n    _current = newProvider;\n  },\n  _setDisabled: isDisabled => {\n    if (isDisabled) {\n      _current = _inMemoryProvider;\n    } else {\n      _current = _main;\n    }\n  }\n};\nfunction _getObjectFromStorage(key) {\n  const value = exports.Storage.getItem(key);\n  return JSON.parse(value !== null && value !== void 0 ? value : 'null');\n}\nexports._getObjectFromStorage = _getObjectFromStorage;\nfunction _setObjectInStorage(key, obj) {\n  exports.Storage.setItem(key, JSON.stringify(obj));\n}\nexports._setObjectInStorage = _setObjectInStorage;","map":{"version":3,"names":["Object","defineProperty","exports","value","_setObjectInStorage","_getObjectFromStorage","Storage","Log_1","require","SafeJs_1","inMemoryStore","_inMemoryProvider","isReady","isReadyResolver","getProviderName","getItem","key","setItem","removeItem","getAllKeys","keys","_localStorageProvider","win","_getWindowSafe","localStorage","error","Log","warn","_main","_current","_inMemoryBreaker","action","Error","name","_setProvider","newProvider","_setDisabled","isDisabled","JSON","parse","obj","stringify"],"sources":["/Users/sidiq/Documents/OptiviseWeb/node_modules/@statsig/client-core/src/StorageProvider.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports._setObjectInStorage = exports._getObjectFromStorage = exports.Storage = void 0;\nconst Log_1 = require(\"./Log\");\nconst SafeJs_1 = require(\"./SafeJs\");\nconst inMemoryStore = {};\nconst _inMemoryProvider = {\n    isReady: () => true,\n    isReadyResolver: () => null,\n    getProviderName: () => 'InMemory',\n    getItem: (key) => inMemoryStore[key] ? inMemoryStore[key] : null,\n    setItem: (key, value) => {\n        inMemoryStore[key] = value;\n    },\n    removeItem: (key) => {\n        delete inMemoryStore[key];\n    },\n    getAllKeys: () => Object.keys(inMemoryStore),\n};\nlet _localStorageProvider = null;\ntry {\n    const win = (0, SafeJs_1._getWindowSafe)();\n    if (win &&\n        win.localStorage &&\n        typeof win.localStorage.getItem === 'function') {\n        _localStorageProvider = {\n            isReady: () => true,\n            isReadyResolver: () => null,\n            getProviderName: () => 'LocalStorage',\n            getItem: (key) => win.localStorage.getItem(key),\n            setItem: (key, value) => win.localStorage.setItem(key, value),\n            removeItem: (key) => win.localStorage.removeItem(key),\n            getAllKeys: () => Object.keys(win.localStorage),\n        };\n    }\n}\ncatch (error) {\n    Log_1.Log.warn('Failed to setup localStorageProvider.');\n}\nlet _main = _localStorageProvider !== null && _localStorageProvider !== void 0 ? _localStorageProvider : _inMemoryProvider;\nlet _current = _main;\nfunction _inMemoryBreaker(action) {\n    try {\n        return action();\n    }\n    catch (error) {\n        if (error instanceof Error && error.name === 'SecurityError') {\n            exports.Storage._setProvider(_inMemoryProvider);\n            return null;\n        }\n        throw error;\n    }\n}\nexports.Storage = {\n    isReady: () => _current.isReady(),\n    isReadyResolver: () => _current.isReadyResolver(),\n    getProviderName: () => _current.getProviderName(),\n    getItem: (key) => _inMemoryBreaker(() => _current.getItem(key)),\n    setItem: (key, value) => _inMemoryBreaker(() => _current.setItem(key, value)),\n    removeItem: (key) => _current.removeItem(key),\n    getAllKeys: () => _current.getAllKeys(),\n    // StorageProviderManagment\n    _setProvider: (newProvider) => {\n        _main = newProvider;\n        _current = newProvider;\n    },\n    _setDisabled: (isDisabled) => {\n        if (isDisabled) {\n            _current = _inMemoryProvider;\n        }\n        else {\n            _current = _main;\n        }\n    },\n};\nfunction _getObjectFromStorage(key) {\n    const value = exports.Storage.getItem(key);\n    return JSON.parse(value !== null && value !== void 0 ? value : 'null');\n}\nexports._getObjectFromStorage = _getObjectFromStorage;\nfunction _setObjectInStorage(key, obj) {\n    exports.Storage.setItem(key, JSON.stringify(obj));\n}\nexports._setObjectInStorage = _setObjectInStorage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}