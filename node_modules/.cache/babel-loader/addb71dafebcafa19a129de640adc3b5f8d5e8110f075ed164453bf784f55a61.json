{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.EngagementManager = void 0;\nconst client_core_1 = require(\"@statsig/client-core\");\nconst PAGE_INACTIVE_TIMEOUT = 600000; // 10 minutes\nclass EngagementManager {\n  constructor() {\n    this._lastScrollY = 0;\n    this._maxScrollY = 0;\n    this._lastScrollPercentage = 0;\n    this._maxScrollPercentage = 0;\n    this._lastPageViewTime = Date.now();\n    this._inactiveTimer = null;\n    this._onInactivityCallback = null;\n    this._meaningfulEngagementOccurred = false;\n    this._initializeScrollTracking();\n  }\n  _initializeScrollTracking() {\n    const win = (0, client_core_1._getWindowSafe)();\n    if (!win) return;\n    win.addEventListener('scroll', () => this._handleScroll());\n    win.addEventListener('scrollend', () => this._handleScroll());\n    win.addEventListener('resize', () => this._handleScroll());\n  }\n  _handleScroll() {\n    const win = (0, client_core_1._getWindowSafe)();\n    const doc = (0, client_core_1._getDocumentSafe)();\n    if (!win || !doc) return;\n    const scrollHeight = doc.body.scrollHeight;\n    const scrollY = win.scrollY || doc.documentElement.scrollTop || 0;\n    const innerHeight = win.innerHeight;\n    this._lastScrollY = scrollY;\n    this._maxScrollY = Math.max(this._maxScrollY, scrollY);\n    const currentScrollPercentage = Math.min(100, Math.round((scrollY + innerHeight) / scrollHeight * 100));\n    this._lastScrollPercentage = currentScrollPercentage;\n    this._maxScrollPercentage = Math.max(this._maxScrollPercentage, currentScrollPercentage);\n    this.bumpInactiveTimer();\n  }\n  getScrollMetrics() {\n    return {\n      lastScrollY: this._lastScrollY,\n      maxScrollY: this._maxScrollY,\n      lastScrollPercentage: this._lastScrollPercentage,\n      maxScrollPercentage: this._maxScrollPercentage,\n      scrollDepth: this._maxScrollPercentage // deprecated\n    };\n  }\n  getPageViewLength() {\n    return Date.now() - this._lastPageViewTime;\n  }\n  setLastPageViewTime(time) {\n    this._lastPageViewTime = time;\n  }\n  startInactivityTracking(callback) {\n    this._onInactivityCallback = callback;\n  }\n  bumpInactiveTimer() {\n    const win = (0, client_core_1._getWindowSafe)();\n    if (!win) {\n      return;\n    }\n    if (this._inactiveTimer) {\n      clearTimeout(this._inactiveTimer);\n    }\n    this._inactiveTimer = win.setTimeout(() => {\n      if (this._onInactivityCallback) {\n        this._onInactivityCallback();\n      }\n    }, PAGE_INACTIVE_TIMEOUT);\n  }\n  setMeaningfulEngagementOccurred(occurred) {\n    this._meaningfulEngagementOccurred = occurred;\n  }\n  getPageViewEndMetadata() {\n    const pageviewEndMetadata = Object.assign(Object.assign({}, this.getScrollMetrics()), {\n      pageViewLength: this.getPageViewLength(),\n      meaningfulEngagementOccurred: this._meaningfulEngagementOccurred\n    });\n    this.setMeaningfulEngagementOccurred(false);\n    return pageviewEndMetadata;\n  }\n}\nexports.EngagementManager = EngagementManager;","map":{"version":3,"names":["Object","defineProperty","exports","value","EngagementManager","client_core_1","require","PAGE_INACTIVE_TIMEOUT","constructor","_lastScrollY","_maxScrollY","_lastScrollPercentage","_maxScrollPercentage","_lastPageViewTime","Date","now","_inactiveTimer","_onInactivityCallback","_meaningfulEngagementOccurred","_initializeScrollTracking","win","_getWindowSafe","addEventListener","_handleScroll","doc","_getDocumentSafe","scrollHeight","body","scrollY","documentElement","scrollTop","innerHeight","Math","max","currentScrollPercentage","min","round","bumpInactiveTimer","getScrollMetrics","lastScrollY","maxScrollY","lastScrollPercentage","maxScrollPercentage","scrollDepth","getPageViewLength","setLastPageViewTime","time","startInactivityTracking","callback","clearTimeout","setTimeout","setMeaningfulEngagementOccurred","occurred","getPageViewEndMetadata","pageviewEndMetadata","assign","pageViewLength","meaningfulEngagementOccurred"],"sources":["/Users/sidiq/Documents/OptiviseWeb/node_modules/@statsig/web-analytics/src/EngagementManager.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.EngagementManager = void 0;\nconst client_core_1 = require(\"@statsig/client-core\");\nconst PAGE_INACTIVE_TIMEOUT = 600000; // 10 minutes\nclass EngagementManager {\n    constructor() {\n        this._lastScrollY = 0;\n        this._maxScrollY = 0;\n        this._lastScrollPercentage = 0;\n        this._maxScrollPercentage = 0;\n        this._lastPageViewTime = Date.now();\n        this._inactiveTimer = null;\n        this._onInactivityCallback = null;\n        this._meaningfulEngagementOccurred = false;\n        this._initializeScrollTracking();\n    }\n    _initializeScrollTracking() {\n        const win = (0, client_core_1._getWindowSafe)();\n        if (!win)\n            return;\n        win.addEventListener('scroll', () => this._handleScroll());\n        win.addEventListener('scrollend', () => this._handleScroll());\n        win.addEventListener('resize', () => this._handleScroll());\n    }\n    _handleScroll() {\n        const win = (0, client_core_1._getWindowSafe)();\n        const doc = (0, client_core_1._getDocumentSafe)();\n        if (!win || !doc)\n            return;\n        const scrollHeight = doc.body.scrollHeight;\n        const scrollY = win.scrollY || doc.documentElement.scrollTop || 0;\n        const innerHeight = win.innerHeight;\n        this._lastScrollY = scrollY;\n        this._maxScrollY = Math.max(this._maxScrollY, scrollY);\n        const currentScrollPercentage = Math.min(100, Math.round(((scrollY + innerHeight) / scrollHeight) * 100));\n        this._lastScrollPercentage = currentScrollPercentage;\n        this._maxScrollPercentage = Math.max(this._maxScrollPercentage, currentScrollPercentage);\n        this.bumpInactiveTimer();\n    }\n    getScrollMetrics() {\n        return {\n            lastScrollY: this._lastScrollY,\n            maxScrollY: this._maxScrollY,\n            lastScrollPercentage: this._lastScrollPercentage,\n            maxScrollPercentage: this._maxScrollPercentage,\n            scrollDepth: this._maxScrollPercentage, // deprecated\n        };\n    }\n    getPageViewLength() {\n        return Date.now() - this._lastPageViewTime;\n    }\n    setLastPageViewTime(time) {\n        this._lastPageViewTime = time;\n    }\n    startInactivityTracking(callback) {\n        this._onInactivityCallback = callback;\n    }\n    bumpInactiveTimer() {\n        const win = (0, client_core_1._getWindowSafe)();\n        if (!win) {\n            return;\n        }\n        if (this._inactiveTimer) {\n            clearTimeout(this._inactiveTimer);\n        }\n        this._inactiveTimer = win.setTimeout(() => {\n            if (this._onInactivityCallback) {\n                this._onInactivityCallback();\n            }\n        }, PAGE_INACTIVE_TIMEOUT);\n    }\n    setMeaningfulEngagementOccurred(occurred) {\n        this._meaningfulEngagementOccurred = occurred;\n    }\n    getPageViewEndMetadata() {\n        const pageviewEndMetadata = Object.assign(Object.assign({}, this.getScrollMetrics()), { pageViewLength: this.getPageViewLength(), meaningfulEngagementOccurred: this._meaningfulEngagementOccurred });\n        this.setMeaningfulEngagementOccurred(false);\n        return pageviewEndMetadata;\n    }\n}\nexports.EngagementManager = EngagementManager;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}