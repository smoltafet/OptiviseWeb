{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getCookieName = exports.StableID = void 0;\nconst CacheKey_1 = require(\"./CacheKey\");\nconst Log_1 = require(\"./Log\");\nconst SafeJs_1 = require(\"./SafeJs\");\nconst StorageProvider_1 = require(\"./StorageProvider\");\nconst UUID_1 = require(\"./UUID\");\nconst PROMISE_MAP = {};\nconst COOKIE_ENABLED_MAP = {};\nconst DISABLED_MAP = {};\nexports.StableID = {\n  cookiesEnabled: false,\n  randomID: Math.random().toString(36),\n  get: sdkKey => {\n    if (DISABLED_MAP[sdkKey]) {\n      return null;\n    }\n    if (PROMISE_MAP[sdkKey] != null) {\n      return PROMISE_MAP[sdkKey];\n    }\n    let stableID = null;\n    stableID = _loadFromCookie(sdkKey);\n    if (stableID != null) {\n      PROMISE_MAP[sdkKey] = stableID;\n      _persistToStorage(stableID, sdkKey);\n      return stableID;\n    }\n    stableID = _loadFromStorage(sdkKey);\n    if (stableID == null) {\n      stableID = (0, UUID_1.getUUID)();\n    }\n    _persistToStorage(stableID, sdkKey);\n    _persistToCookie(stableID, sdkKey);\n    PROMISE_MAP[sdkKey] = stableID;\n    return stableID;\n  },\n  setOverride: (override, sdkKey) => {\n    PROMISE_MAP[sdkKey] = override;\n    _persistToStorage(override, sdkKey);\n    _persistToCookie(override, sdkKey);\n  },\n  _setCookiesEnabled: (sdkKey, cookiesEnabled) => {\n    COOKIE_ENABLED_MAP[sdkKey] = cookiesEnabled;\n  },\n  _setDisabled: (sdkKey, disabled) => {\n    DISABLED_MAP[sdkKey] = disabled;\n  }\n};\nfunction _getStableIDStorageKey(sdkKey) {\n  return `statsig.stable_id.${(0, CacheKey_1._getStorageKey)(sdkKey)}`;\n}\nfunction _persistToStorage(stableID, sdkKey) {\n  const storageKey = _getStableIDStorageKey(sdkKey);\n  try {\n    (0, StorageProvider_1._setObjectInStorage)(storageKey, stableID);\n  } catch (e) {\n    Log_1.Log.warn('Failed to save StableID to storage');\n  }\n}\nfunction _loadFromStorage(sdkKey) {\n  const storageKey = _getStableIDStorageKey(sdkKey);\n  return (0, StorageProvider_1._getObjectFromStorage)(storageKey);\n}\nfunction _loadFromCookie(sdkKey) {\n  if (!COOKIE_ENABLED_MAP[sdkKey] || (0, SafeJs_1._getDocumentSafe)() == null) {\n    return null;\n  }\n  const cookies = document.cookie.split(';');\n  for (const cookie of cookies) {\n    const [key, value] = cookie.trim().split('=');\n    if (key === getCookieName(sdkKey)) {\n      return decodeURIComponent(value);\n    }\n  }\n  return null;\n}\nfunction _persistToCookie(stableID, sdkKey) {\n  if (!COOKIE_ENABLED_MAP[sdkKey] || (0, SafeJs_1._getDocumentSafe)() == null) {\n    return;\n  }\n  const expiryDate = new Date();\n  expiryDate.setFullYear(expiryDate.getFullYear() + 1);\n  document.cookie = `${getCookieName(sdkKey)}=${encodeURIComponent(stableID)}; expires=${expiryDate.toUTCString()}; path=/`;\n}\nfunction getCookieName(sdkKey) {\n  return `statsig.stable_id.${(0, CacheKey_1._getStorageKey)(sdkKey)}`;\n}\nexports.getCookieName = getCookieName;","map":{"version":3,"names":["Object","defineProperty","exports","value","getCookieName","StableID","CacheKey_1","require","Log_1","SafeJs_1","StorageProvider_1","UUID_1","PROMISE_MAP","COOKIE_ENABLED_MAP","DISABLED_MAP","cookiesEnabled","randomID","Math","random","toString","get","sdkKey","stableID","_loadFromCookie","_persistToStorage","_loadFromStorage","getUUID","_persistToCookie","setOverride","override","_setCookiesEnabled","_setDisabled","disabled","_getStableIDStorageKey","_getStorageKey","storageKey","_setObjectInStorage","e","Log","warn","_getObjectFromStorage","_getDocumentSafe","cookies","document","cookie","split","key","trim","decodeURIComponent","expiryDate","Date","setFullYear","getFullYear","encodeURIComponent","toUTCString"],"sources":["/Users/sidiq/Documents/OptiviseWeb/node_modules/@statsig/client-core/src/StableID.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getCookieName = exports.StableID = void 0;\nconst CacheKey_1 = require(\"./CacheKey\");\nconst Log_1 = require(\"./Log\");\nconst SafeJs_1 = require(\"./SafeJs\");\nconst StorageProvider_1 = require(\"./StorageProvider\");\nconst UUID_1 = require(\"./UUID\");\nconst PROMISE_MAP = {};\nconst COOKIE_ENABLED_MAP = {};\nconst DISABLED_MAP = {};\nexports.StableID = {\n    cookiesEnabled: false,\n    randomID: Math.random().toString(36),\n    get: (sdkKey) => {\n        if (DISABLED_MAP[sdkKey]) {\n            return null;\n        }\n        if (PROMISE_MAP[sdkKey] != null) {\n            return PROMISE_MAP[sdkKey];\n        }\n        let stableID = null;\n        stableID = _loadFromCookie(sdkKey);\n        if (stableID != null) {\n            PROMISE_MAP[sdkKey] = stableID;\n            _persistToStorage(stableID, sdkKey);\n            return stableID;\n        }\n        stableID = _loadFromStorage(sdkKey);\n        if (stableID == null) {\n            stableID = (0, UUID_1.getUUID)();\n        }\n        _persistToStorage(stableID, sdkKey);\n        _persistToCookie(stableID, sdkKey);\n        PROMISE_MAP[sdkKey] = stableID;\n        return stableID;\n    },\n    setOverride: (override, sdkKey) => {\n        PROMISE_MAP[sdkKey] = override;\n        _persistToStorage(override, sdkKey);\n        _persistToCookie(override, sdkKey);\n    },\n    _setCookiesEnabled: (sdkKey, cookiesEnabled) => {\n        COOKIE_ENABLED_MAP[sdkKey] = cookiesEnabled;\n    },\n    _setDisabled: (sdkKey, disabled) => {\n        DISABLED_MAP[sdkKey] = disabled;\n    },\n};\nfunction _getStableIDStorageKey(sdkKey) {\n    return `statsig.stable_id.${(0, CacheKey_1._getStorageKey)(sdkKey)}`;\n}\nfunction _persistToStorage(stableID, sdkKey) {\n    const storageKey = _getStableIDStorageKey(sdkKey);\n    try {\n        (0, StorageProvider_1._setObjectInStorage)(storageKey, stableID);\n    }\n    catch (e) {\n        Log_1.Log.warn('Failed to save StableID to storage');\n    }\n}\nfunction _loadFromStorage(sdkKey) {\n    const storageKey = _getStableIDStorageKey(sdkKey);\n    return (0, StorageProvider_1._getObjectFromStorage)(storageKey);\n}\nfunction _loadFromCookie(sdkKey) {\n    if (!COOKIE_ENABLED_MAP[sdkKey] || (0, SafeJs_1._getDocumentSafe)() == null) {\n        return null;\n    }\n    const cookies = document.cookie.split(';');\n    for (const cookie of cookies) {\n        const [key, value] = cookie.trim().split('=');\n        if (key === getCookieName(sdkKey)) {\n            return decodeURIComponent(value);\n        }\n    }\n    return null;\n}\nfunction _persistToCookie(stableID, sdkKey) {\n    if (!COOKIE_ENABLED_MAP[sdkKey] || (0, SafeJs_1._getDocumentSafe)() == null) {\n        return;\n    }\n    const expiryDate = new Date();\n    expiryDate.setFullYear(expiryDate.getFullYear() + 1);\n    document.cookie = `${getCookieName(sdkKey)}=${encodeURIComponent(stableID)}; expires=${expiryDate.toUTCString()}; path=/`;\n}\nfunction getCookieName(sdkKey) {\n    return `statsig.stable_id.${(0, CacheKey_1._getStorageKey)(sdkKey)}`;\n}\nexports.getCookieName = getCookieName;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}