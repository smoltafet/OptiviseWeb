{"ast":null,"code":"\"use strict\";\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.NetworkCore = void 0;\nrequire(\"./$_StatsigGlobal\");\nconst __StatsigGlobal_1 = require(\"./$_StatsigGlobal\");\nconst Diagnostics_1 = require(\"./Diagnostics\");\nconst Log_1 = require(\"./Log\");\nconst NetworkConfig_1 = require(\"./NetworkConfig\");\nconst NetworkFallbackResolver_1 = require(\"./NetworkFallbackResolver\");\nconst SDKFlags_1 = require(\"./SDKFlags\");\nconst SDKType_1 = require(\"./SDKType\");\nconst SafeJs_1 = require(\"./SafeJs\");\nconst SessionID_1 = require(\"./SessionID\");\nconst StableID_1 = require(\"./StableID\");\nconst StatsigClientEventEmitter_1 = require(\"./StatsigClientEventEmitter\");\nconst StatsigMetadata_1 = require(\"./StatsigMetadata\");\nconst StatsigOptionsCommon_1 = require(\"./StatsigOptionsCommon\");\nconst VisibilityObserving_1 = require(\"./VisibilityObserving\");\nconst DEFAULT_TIMEOUT_MS = 10000;\nconst BACKOFF_BASE_MS = 500;\nconst BACKOFF_MAX_MS = 30000;\nconst RATE_LIMIT_WINDOW_MS = 1000;\nconst RATE_LIMIT_MAX_REQ_COUNT = 50;\nconst LEAK_RATE = RATE_LIMIT_MAX_REQ_COUNT / RATE_LIMIT_WINDOW_MS;\nconst RETRYABLE_CODES = new Set([408, 500, 502, 503, 504, 522, 524, 599]);\nclass NetworkCore {\n  constructor(options, _emitter) {\n    this._emitter = _emitter;\n    this._errorBoundary = null;\n    this._timeout = DEFAULT_TIMEOUT_MS;\n    this._netConfig = {};\n    this._options = {};\n    this._leakyBucket = {};\n    this._lastUsedInitUrl = null;\n    if (options) {\n      this._options = options;\n    }\n    if (this._options.networkConfig) {\n      this._netConfig = this._options.networkConfig;\n    }\n    if (this._netConfig.networkTimeoutMs) {\n      this._timeout = this._netConfig.networkTimeoutMs;\n    }\n    this._fallbackResolver = new NetworkFallbackResolver_1.NetworkFallbackResolver(this._options);\n    this.setLogEventCompressionMode(this._getLogEventCompressionMode(options));\n  }\n  setLogEventCompressionMode(mode) {\n    this._options.logEventCompressionMode = mode;\n  }\n  setErrorBoundary(errorBoundary) {\n    this._errorBoundary = errorBoundary;\n    this._errorBoundary.wrap(this);\n    this._errorBoundary.wrap(this._fallbackResolver);\n    this._fallbackResolver.setErrorBoundary(errorBoundary);\n  }\n  isBeaconSupported() {\n    return typeof navigator !== 'undefined' && typeof navigator.sendBeacon === 'function';\n  }\n  getLastUsedInitUrlAndReset() {\n    const tempUrl = this._lastUsedInitUrl;\n    this._lastUsedInitUrl = null;\n    return tempUrl;\n  }\n  beacon(args) {\n    if (!_ensureValidSdkKey(args)) {\n      return false;\n    }\n    const argsInternal = this._getInternalRequestArgs('POST', args);\n    const url = this._getPopulatedURL(argsInternal);\n    const nav = navigator;\n    return nav.sendBeacon.bind(nav)(url, argsInternal.body);\n  }\n  post(args) {\n    return __awaiter(this, void 0, void 0, function* () {\n      const argsInternal = this._getInternalRequestArgs('POST', args);\n      this._tryEncodeBody(argsInternal);\n      yield this._tryToCompressBody(argsInternal);\n      return this._sendRequest(argsInternal);\n    });\n  }\n  get(args) {\n    const argsInternal = this._getInternalRequestArgs('GET', args);\n    return this._sendRequest(argsInternal);\n  }\n  _sendRequest(args) {\n    return __awaiter(this, void 0, void 0, function* () {\n      var _a, _b, _c, _d;\n      if (!_ensureValidSdkKey(args)) {\n        return null;\n      }\n      if (this._netConfig.preventAllNetworkTraffic) {\n        return null;\n      }\n      const {\n        method,\n        body,\n        retries,\n        attempt\n      } = args;\n      const endpoint = args.urlConfig.endpoint;\n      if (this._isRateLimited(endpoint)) {\n        Log_1.Log.warn(`Request to ${endpoint} was blocked because you are making requests too frequently.`);\n        return null;\n      }\n      const currentAttempt = attempt !== null && attempt !== void 0 ? attempt : 1;\n      let reqTimedOut = false;\n      const populatedUrl = this._getPopulatedURL(args);\n      let response = null;\n      const keepalive = (0, VisibilityObserving_1._isUnloading)();\n      try {\n        const config = {\n          method,\n          body,\n          headers: Object.assign({}, args.headers),\n          priority: args.priority,\n          keepalive\n        };\n        _tryMarkInitStart(args, currentAttempt);\n        const bucket = this._leakyBucket[endpoint];\n        if (bucket) {\n          bucket.lastRequestTime = Date.now();\n          this._leakyBucket[endpoint] = bucket;\n        }\n        const func = (_a = this._netConfig.networkOverrideFunc) !== null && _a !== void 0 ? _a : fetch;\n        let timeoutId;\n        response = yield Promise.race([func(populatedUrl, config).finally(() => clearTimeout(timeoutId)), new Promise((_, reject) => {\n          timeoutId = setTimeout(() => {\n            reqTimedOut = true;\n            reject(new Error(`Timeout of ${this._timeout}ms expired.`));\n          }, this._timeout);\n        })]);\n        if (!response.ok) {\n          const text = yield response.text().catch(() => 'No Text');\n          const err = new Error(`NetworkError: ${populatedUrl} ${text}`);\n          err.name = 'NetworkError';\n          throw err;\n        }\n        const text = yield response.text();\n        _tryMarkInitEnd(args, response, currentAttempt, text);\n        this._fallbackResolver.tryBumpExpiryTime(args.sdkKey, args.urlConfig);\n        return {\n          body: text,\n          code: response.status\n        };\n      } catch (error) {\n        const errorMessage = _getErrorMessage(error);\n        const timedOut = _didTimeout(errorMessage !== null && errorMessage !== void 0 ? errorMessage : '', reqTimedOut);\n        _tryMarkInitEnd(args, response, currentAttempt, '', error);\n        const fallbackUpdated = yield this._fallbackResolver.tryFetchUpdatedFallbackInfo(args.sdkKey, args.urlConfig, errorMessage, timedOut);\n        if (fallbackUpdated) {\n          args.fallbackUrl = this._fallbackResolver.getActiveFallbackUrl(args.sdkKey, args.urlConfig);\n        }\n        if (!retries || currentAttempt > retries || !RETRYABLE_CODES.has((_b = response === null || response === void 0 ? void 0 : response.status) !== null && _b !== void 0 ? _b : 500)) {\n          (_c = this._emitter) === null || _c === void 0 ? void 0 : _c.call(this, {\n            name: 'error',\n            error,\n            tag: StatsigClientEventEmitter_1.ErrorTag.NetworkError,\n            requestArgs: args\n          });\n          const formattedErrorMsg = `A networking error occurred during ${method} request to ${populatedUrl}.`;\n          Log_1.Log.error(formattedErrorMsg, errorMessage, error);\n          (_d = this._errorBoundary) === null || _d === void 0 ? void 0 : _d.attachErrorIfNoneExists(formattedErrorMsg);\n          return null;\n        }\n        yield _exponentialBackoff(currentAttempt);\n        return this._sendRequest(Object.assign(Object.assign({}, args), {\n          retries,\n          attempt: currentAttempt + 1\n        }));\n      }\n    });\n  }\n  _getLogEventCompressionMode(options) {\n    // Handle backward compatibility for deprecated disableCompression flag\n    let compressionMode = options === null || options === void 0 ? void 0 : options.logEventCompressionMode;\n    if (!compressionMode && (options === null || options === void 0 ? void 0 : options.disableCompression) === true) {\n      compressionMode = StatsigOptionsCommon_1.LogEventCompressionMode.Disabled;\n    }\n    // Default to enabled if unset\n    if (!compressionMode) {\n      compressionMode = StatsigOptionsCommon_1.LogEventCompressionMode.Enabled;\n    }\n    return compressionMode;\n  }\n  _isRateLimited(endpoint) {\n    var _a;\n    const now = Date.now();\n    const bucket = (_a = this._leakyBucket[endpoint]) !== null && _a !== void 0 ? _a : {\n      count: 0,\n      lastRequestTime: now\n    };\n    const elapsed = now - bucket.lastRequestTime;\n    const leakedRequests = Math.floor(elapsed * LEAK_RATE);\n    bucket.count = Math.max(0, bucket.count - leakedRequests);\n    if (bucket.count >= RATE_LIMIT_MAX_REQ_COUNT) {\n      return true;\n    }\n    bucket.count += 1;\n    bucket.lastRequestTime = now;\n    this._leakyBucket[endpoint] = bucket;\n    return false;\n  }\n  _getPopulatedURL(args) {\n    var _a;\n    const url = (_a = args.fallbackUrl) !== null && _a !== void 0 ? _a : args.urlConfig.getUrl();\n    if (args.urlConfig.endpoint === NetworkConfig_1.Endpoint._initialize || args.urlConfig.endpoint === NetworkConfig_1.Endpoint._download_config_specs) {\n      this._lastUsedInitUrl = url;\n    }\n    const params = Object.assign({\n      [NetworkConfig_1.NetworkParam.SdkKey]: args.sdkKey,\n      [NetworkConfig_1.NetworkParam.SdkType]: SDKType_1.SDKType._get(args.sdkKey),\n      [NetworkConfig_1.NetworkParam.SdkVersion]: StatsigMetadata_1.SDK_VERSION,\n      [NetworkConfig_1.NetworkParam.Time]: String(Date.now()),\n      [NetworkConfig_1.NetworkParam.SessionID]: SessionID_1.SessionID.get(args.sdkKey)\n    }, args.params);\n    const query = Object.keys(params).map(key => {\n      return `${encodeURIComponent(key)}=${encodeURIComponent(params[key])}`;\n    }).join('&');\n    return `${url}${query ? `?${query}` : ''}`;\n  }\n  _tryEncodeBody(args) {\n    var _a;\n    const win = (0, SafeJs_1._getWindowSafe)();\n    const body = args.body;\n    if (!args.isStatsigEncodable || this._options.disableStatsigEncoding || typeof body !== 'string' || (0, __StatsigGlobal_1._getStatsigGlobalFlag)('no-encode') != null || !(win === null || win === void 0 ? void 0 : win.btoa)) {\n      return;\n    }\n    try {\n      args.body = win.btoa(body).split('').reverse().join('');\n      args.params = Object.assign(Object.assign({}, (_a = args.params) !== null && _a !== void 0 ? _a : {}), {\n        [NetworkConfig_1.NetworkParam.StatsigEncoded]: '1'\n      });\n    } catch (e) {\n      Log_1.Log.warn(`Request encoding failed for ${args.urlConfig.getUrl()}`, e);\n    }\n  }\n  _tryToCompressBody(args) {\n    return __awaiter(this, void 0, void 0, function* () {\n      var _a;\n      const body = args.body;\n      if (typeof body !== 'string' || !_allowCompression(args, this._options)) {\n        return;\n      }\n      try {\n        const bytes = new TextEncoder().encode(body);\n        const stream = new CompressionStream('gzip');\n        const writer = stream.writable.getWriter();\n        writer.write(bytes).catch(Log_1.Log.error);\n        writer.close().catch(Log_1.Log.error);\n        const reader = stream.readable.getReader();\n        const chunks = [];\n        let result;\n        // eslint-disable-next-line no-await-in-loop\n        while (!(result = yield reader.read()).done) {\n          chunks.push(result.value);\n        }\n        const totalLength = chunks.reduce((acc, chunk) => acc + chunk.length, 0);\n        const combined = new Uint8Array(totalLength);\n        let offset = 0;\n        for (const chunk of chunks) {\n          combined.set(chunk, offset);\n          offset += chunk.length;\n        }\n        args.body = combined;\n        args.params = Object.assign(Object.assign({}, (_a = args.params) !== null && _a !== void 0 ? _a : {}), {\n          [NetworkConfig_1.NetworkParam.IsGzipped]: '1'\n        });\n      } catch (e) {\n        Log_1.Log.warn(`Request compression failed for ${args.urlConfig.getUrl()}`, e);\n      }\n    });\n  }\n  _getInternalRequestArgs(method, args) {\n    const fallbackUrl = this._fallbackResolver.getActiveFallbackUrl(args.sdkKey, args.urlConfig);\n    const result = Object.assign(Object.assign({}, args), {\n      method,\n      fallbackUrl\n    });\n    if ('data' in args) {\n      _populateRequestBody(result, args.data);\n    }\n    return result;\n  }\n}\nexports.NetworkCore = NetworkCore;\nconst _ensureValidSdkKey = args => {\n  if (!args.sdkKey) {\n    Log_1.Log.warn('Unable to make request without an SDK key');\n    return false;\n  }\n  return true;\n};\nconst _populateRequestBody = (args, data) => {\n  const {\n    sdkKey,\n    fallbackUrl\n  } = args;\n  const stableID = StableID_1.StableID.get(sdkKey);\n  const sessionID = SessionID_1.SessionID.get(sdkKey);\n  const sdkType = SDKType_1.SDKType._get(sdkKey);\n  args.body = JSON.stringify(Object.assign(Object.assign({}, data), {\n    statsigMetadata: Object.assign(Object.assign({}, StatsigMetadata_1.StatsigMetadataProvider.get()), {\n      stableID,\n      sessionID,\n      sdkType,\n      fallbackUrl\n    })\n  }));\n};\nfunction _allowCompression(args, options) {\n  if (!args.isCompressable) {\n    return false;\n  }\n  // Never compress if 'no-compress' is set globally or required APIs are unavailable\n  if ((0, __StatsigGlobal_1._getStatsigGlobalFlag)('no-compress') != null || typeof CompressionStream === 'undefined' || typeof TextEncoder === 'undefined') {\n    return false;\n  }\n  const isProxy = args.urlConfig.customUrl != null || args.urlConfig.fallbackUrls != null;\n  const flagEnabled = SDKFlags_1.SDKFlags.get(args.sdkKey, 'enable_log_event_compression') === true;\n  switch (options.logEventCompressionMode) {\n    case StatsigOptionsCommon_1.LogEventCompressionMode.Disabled:\n      return false;\n    case StatsigOptionsCommon_1.LogEventCompressionMode.Enabled:\n      // Only compress through proxy if flag is explicitly on\n      if (isProxy && !flagEnabled) {\n        return false;\n      }\n      return true;\n    case StatsigOptionsCommon_1.LogEventCompressionMode.Forced:\n      return true;\n    default:\n      return false;\n  }\n}\nfunction _getErrorMessage(error) {\n  if (typeof error === 'string') {\n    return error;\n  }\n  if (error instanceof Error) {\n    return `${error.name}: ${error.message}`;\n  }\n  return 'Unknown Error';\n}\nfunction _didTimeout(errorMsg, abortedByTimeout) {\n  const timeout = errorMsg.includes('Timeout'); // probably not needed but just in case\n  return timeout || abortedByTimeout;\n}\nfunction _tryMarkInitStart(args, attempt) {\n  if (args.urlConfig.endpoint !== NetworkConfig_1.Endpoint._initialize) {\n    return;\n  }\n  Diagnostics_1.Diagnostics._markInitNetworkReqStart(args.sdkKey, {\n    attempt\n  });\n}\nfunction _tryMarkInitEnd(args, response, attempt, body, err) {\n  if (args.urlConfig.endpoint !== NetworkConfig_1.Endpoint._initialize) {\n    return;\n  }\n  Diagnostics_1.Diagnostics._markInitNetworkReqEnd(args.sdkKey, Diagnostics_1.Diagnostics._getDiagnosticsData(response, attempt, body, err));\n}\nfunction _exponentialBackoff(attempt) {\n  return __awaiter(this, void 0, void 0, function* () {\n    // 1*1*1000 1s\n    // 2*2*1000 4s\n    // 3*3*1000 9s\n    // 4*4*1000 16s\n    // 5*5*1000 25s\n    yield new Promise(r => setTimeout(r, Math.min(BACKOFF_BASE_MS * (attempt * attempt), BACKOFF_MAX_MS)));\n  });\n}","map":{"version":3,"names":["__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","Object","defineProperty","exports","NetworkCore","require","__StatsigGlobal_1","Diagnostics_1","Log_1","NetworkConfig_1","NetworkFallbackResolver_1","SDKFlags_1","SDKType_1","SafeJs_1","SessionID_1","StableID_1","StatsigClientEventEmitter_1","StatsigMetadata_1","StatsigOptionsCommon_1","VisibilityObserving_1","DEFAULT_TIMEOUT_MS","BACKOFF_BASE_MS","BACKOFF_MAX_MS","RATE_LIMIT_WINDOW_MS","RATE_LIMIT_MAX_REQ_COUNT","LEAK_RATE","RETRYABLE_CODES","Set","constructor","options","_emitter","_errorBoundary","_timeout","_netConfig","_options","_leakyBucket","_lastUsedInitUrl","networkConfig","networkTimeoutMs","_fallbackResolver","NetworkFallbackResolver","setLogEventCompressionMode","_getLogEventCompressionMode","mode","logEventCompressionMode","setErrorBoundary","errorBoundary","wrap","isBeaconSupported","navigator","sendBeacon","getLastUsedInitUrlAndReset","tempUrl","beacon","args","_ensureValidSdkKey","argsInternal","_getInternalRequestArgs","url","_getPopulatedURL","nav","bind","body","post","_tryEncodeBody","_tryToCompressBody","_sendRequest","get","_a","_b","_c","_d","preventAllNetworkTraffic","method","retries","attempt","endpoint","urlConfig","_isRateLimited","Log","warn","currentAttempt","reqTimedOut","populatedUrl","response","keepalive","_isUnloading","config","headers","assign","priority","_tryMarkInitStart","bucket","lastRequestTime","Date","now","func","networkOverrideFunc","fetch","timeoutId","race","finally","clearTimeout","_","setTimeout","Error","ok","text","catch","err","name","_tryMarkInitEnd","tryBumpExpiryTime","sdkKey","code","status","error","errorMessage","_getErrorMessage","timedOut","_didTimeout","fallbackUpdated","tryFetchUpdatedFallbackInfo","fallbackUrl","getActiveFallbackUrl","has","call","tag","ErrorTag","NetworkError","requestArgs","formattedErrorMsg","attachErrorIfNoneExists","_exponentialBackoff","compressionMode","disableCompression","LogEventCompressionMode","Disabled","Enabled","count","elapsed","leakedRequests","Math","floor","max","getUrl","Endpoint","_initialize","_download_config_specs","params","NetworkParam","SdkKey","SdkType","SDKType","_get","SdkVersion","SDK_VERSION","Time","String","SessionID","query","keys","map","key","encodeURIComponent","join","win","_getWindowSafe","isStatsigEncodable","disableStatsigEncoding","_getStatsigGlobalFlag","btoa","split","reverse","StatsigEncoded","_allowCompression","bytes","TextEncoder","encode","stream","CompressionStream","writer","writable","getWriter","write","close","reader","readable","getReader","chunks","read","push","totalLength","reduce","acc","chunk","length","combined","Uint8Array","offset","set","IsGzipped","_populateRequestBody","data","stableID","StableID","sessionID","sdkType","JSON","stringify","statsigMetadata","StatsigMetadataProvider","isCompressable","isProxy","customUrl","fallbackUrls","flagEnabled","SDKFlags","Forced","message","errorMsg","abortedByTimeout","timeout","includes","Diagnostics","_markInitNetworkReqStart","_markInitNetworkReqEnd","_getDiagnosticsData","r","min"],"sources":["/Users/sidiq/Documents/OptiviseWeb/node_modules/@statsig/client-core/src/NetworkCore.js"],"sourcesContent":["\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.NetworkCore = void 0;\nrequire(\"./$_StatsigGlobal\");\nconst __StatsigGlobal_1 = require(\"./$_StatsigGlobal\");\nconst Diagnostics_1 = require(\"./Diagnostics\");\nconst Log_1 = require(\"./Log\");\nconst NetworkConfig_1 = require(\"./NetworkConfig\");\nconst NetworkFallbackResolver_1 = require(\"./NetworkFallbackResolver\");\nconst SDKFlags_1 = require(\"./SDKFlags\");\nconst SDKType_1 = require(\"./SDKType\");\nconst SafeJs_1 = require(\"./SafeJs\");\nconst SessionID_1 = require(\"./SessionID\");\nconst StableID_1 = require(\"./StableID\");\nconst StatsigClientEventEmitter_1 = require(\"./StatsigClientEventEmitter\");\nconst StatsigMetadata_1 = require(\"./StatsigMetadata\");\nconst StatsigOptionsCommon_1 = require(\"./StatsigOptionsCommon\");\nconst VisibilityObserving_1 = require(\"./VisibilityObserving\");\nconst DEFAULT_TIMEOUT_MS = 10000;\nconst BACKOFF_BASE_MS = 500;\nconst BACKOFF_MAX_MS = 30000;\nconst RATE_LIMIT_WINDOW_MS = 1000;\nconst RATE_LIMIT_MAX_REQ_COUNT = 50;\nconst LEAK_RATE = RATE_LIMIT_MAX_REQ_COUNT / RATE_LIMIT_WINDOW_MS;\nconst RETRYABLE_CODES = new Set([408, 500, 502, 503, 504, 522, 524, 599]);\nclass NetworkCore {\n    constructor(options, _emitter) {\n        this._emitter = _emitter;\n        this._errorBoundary = null;\n        this._timeout = DEFAULT_TIMEOUT_MS;\n        this._netConfig = {};\n        this._options = {};\n        this._leakyBucket = {};\n        this._lastUsedInitUrl = null;\n        if (options) {\n            this._options = options;\n        }\n        if (this._options.networkConfig) {\n            this._netConfig = this._options.networkConfig;\n        }\n        if (this._netConfig.networkTimeoutMs) {\n            this._timeout = this._netConfig.networkTimeoutMs;\n        }\n        this._fallbackResolver = new NetworkFallbackResolver_1.NetworkFallbackResolver(this._options);\n        this.setLogEventCompressionMode(this._getLogEventCompressionMode(options));\n    }\n    setLogEventCompressionMode(mode) {\n        this._options.logEventCompressionMode = mode;\n    }\n    setErrorBoundary(errorBoundary) {\n        this._errorBoundary = errorBoundary;\n        this._errorBoundary.wrap(this);\n        this._errorBoundary.wrap(this._fallbackResolver);\n        this._fallbackResolver.setErrorBoundary(errorBoundary);\n    }\n    isBeaconSupported() {\n        return (typeof navigator !== 'undefined' &&\n            typeof navigator.sendBeacon === 'function');\n    }\n    getLastUsedInitUrlAndReset() {\n        const tempUrl = this._lastUsedInitUrl;\n        this._lastUsedInitUrl = null;\n        return tempUrl;\n    }\n    beacon(args) {\n        if (!_ensureValidSdkKey(args)) {\n            return false;\n        }\n        const argsInternal = this._getInternalRequestArgs('POST', args);\n        const url = this._getPopulatedURL(argsInternal);\n        const nav = navigator;\n        return nav.sendBeacon.bind(nav)(url, argsInternal.body);\n    }\n    post(args) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const argsInternal = this._getInternalRequestArgs('POST', args);\n            this._tryEncodeBody(argsInternal);\n            yield this._tryToCompressBody(argsInternal);\n            return this._sendRequest(argsInternal);\n        });\n    }\n    get(args) {\n        const argsInternal = this._getInternalRequestArgs('GET', args);\n        return this._sendRequest(argsInternal);\n    }\n    _sendRequest(args) {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a, _b, _c, _d;\n            if (!_ensureValidSdkKey(args)) {\n                return null;\n            }\n            if (this._netConfig.preventAllNetworkTraffic) {\n                return null;\n            }\n            const { method, body, retries, attempt } = args;\n            const endpoint = args.urlConfig.endpoint;\n            if (this._isRateLimited(endpoint)) {\n                Log_1.Log.warn(`Request to ${endpoint} was blocked because you are making requests too frequently.`);\n                return null;\n            }\n            const currentAttempt = attempt !== null && attempt !== void 0 ? attempt : 1;\n            let reqTimedOut = false;\n            const populatedUrl = this._getPopulatedURL(args);\n            let response = null;\n            const keepalive = (0, VisibilityObserving_1._isUnloading)();\n            try {\n                const config = {\n                    method,\n                    body,\n                    headers: Object.assign({}, args.headers),\n                    priority: args.priority,\n                    keepalive,\n                };\n                _tryMarkInitStart(args, currentAttempt);\n                const bucket = this._leakyBucket[endpoint];\n                if (bucket) {\n                    bucket.lastRequestTime = Date.now();\n                    this._leakyBucket[endpoint] = bucket;\n                }\n                const func = (_a = this._netConfig.networkOverrideFunc) !== null && _a !== void 0 ? _a : fetch;\n                let timeoutId;\n                response = yield Promise.race([\n                    func(populatedUrl, config).finally(() => clearTimeout(timeoutId)),\n                    new Promise((_, reject) => {\n                        timeoutId = setTimeout(() => {\n                            reqTimedOut = true;\n                            reject(new Error(`Timeout of ${this._timeout}ms expired.`));\n                        }, this._timeout);\n                    }),\n                ]);\n                if (!response.ok) {\n                    const text = yield response.text().catch(() => 'No Text');\n                    const err = new Error(`NetworkError: ${populatedUrl} ${text}`);\n                    err.name = 'NetworkError';\n                    throw err;\n                }\n                const text = yield response.text();\n                _tryMarkInitEnd(args, response, currentAttempt, text);\n                this._fallbackResolver.tryBumpExpiryTime(args.sdkKey, args.urlConfig);\n                return {\n                    body: text,\n                    code: response.status,\n                };\n            }\n            catch (error) {\n                const errorMessage = _getErrorMessage(error);\n                const timedOut = _didTimeout(errorMessage !== null && errorMessage !== void 0 ? errorMessage : '', reqTimedOut);\n                _tryMarkInitEnd(args, response, currentAttempt, '', error);\n                const fallbackUpdated = yield this._fallbackResolver.tryFetchUpdatedFallbackInfo(args.sdkKey, args.urlConfig, errorMessage, timedOut);\n                if (fallbackUpdated) {\n                    args.fallbackUrl = this._fallbackResolver.getActiveFallbackUrl(args.sdkKey, args.urlConfig);\n                }\n                if (!retries ||\n                    currentAttempt > retries ||\n                    !RETRYABLE_CODES.has((_b = response === null || response === void 0 ? void 0 : response.status) !== null && _b !== void 0 ? _b : 500)) {\n                    (_c = this._emitter) === null || _c === void 0 ? void 0 : _c.call(this, {\n                        name: 'error',\n                        error,\n                        tag: StatsigClientEventEmitter_1.ErrorTag.NetworkError,\n                        requestArgs: args,\n                    });\n                    const formattedErrorMsg = `A networking error occurred during ${method} request to ${populatedUrl}.`;\n                    Log_1.Log.error(formattedErrorMsg, errorMessage, error);\n                    (_d = this._errorBoundary) === null || _d === void 0 ? void 0 : _d.attachErrorIfNoneExists(formattedErrorMsg);\n                    return null;\n                }\n                yield _exponentialBackoff(currentAttempt);\n                return this._sendRequest(Object.assign(Object.assign({}, args), { retries, attempt: currentAttempt + 1 }));\n            }\n        });\n    }\n    _getLogEventCompressionMode(options) {\n        // Handle backward compatibility for deprecated disableCompression flag\n        let compressionMode = options === null || options === void 0 ? void 0 : options.logEventCompressionMode;\n        if (!compressionMode && (options === null || options === void 0 ? void 0 : options.disableCompression) === true) {\n            compressionMode = StatsigOptionsCommon_1.LogEventCompressionMode.Disabled;\n        }\n        // Default to enabled if unset\n        if (!compressionMode) {\n            compressionMode = StatsigOptionsCommon_1.LogEventCompressionMode.Enabled;\n        }\n        return compressionMode;\n    }\n    _isRateLimited(endpoint) {\n        var _a;\n        const now = Date.now();\n        const bucket = (_a = this._leakyBucket[endpoint]) !== null && _a !== void 0 ? _a : {\n            count: 0,\n            lastRequestTime: now,\n        };\n        const elapsed = now - bucket.lastRequestTime;\n        const leakedRequests = Math.floor(elapsed * LEAK_RATE);\n        bucket.count = Math.max(0, bucket.count - leakedRequests);\n        if (bucket.count >= RATE_LIMIT_MAX_REQ_COUNT) {\n            return true;\n        }\n        bucket.count += 1;\n        bucket.lastRequestTime = now;\n        this._leakyBucket[endpoint] = bucket;\n        return false;\n    }\n    _getPopulatedURL(args) {\n        var _a;\n        const url = (_a = args.fallbackUrl) !== null && _a !== void 0 ? _a : args.urlConfig.getUrl();\n        if (args.urlConfig.endpoint === NetworkConfig_1.Endpoint._initialize ||\n            args.urlConfig.endpoint === NetworkConfig_1.Endpoint._download_config_specs) {\n            this._lastUsedInitUrl = url;\n        }\n        const params = Object.assign({ [NetworkConfig_1.NetworkParam.SdkKey]: args.sdkKey, [NetworkConfig_1.NetworkParam.SdkType]: SDKType_1.SDKType._get(args.sdkKey), [NetworkConfig_1.NetworkParam.SdkVersion]: StatsigMetadata_1.SDK_VERSION, [NetworkConfig_1.NetworkParam.Time]: String(Date.now()), [NetworkConfig_1.NetworkParam.SessionID]: SessionID_1.SessionID.get(args.sdkKey) }, args.params);\n        const query = Object.keys(params)\n            .map((key) => {\n            return `${encodeURIComponent(key)}=${encodeURIComponent(params[key])}`;\n        })\n            .join('&');\n        return `${url}${query ? `?${query}` : ''}`;\n    }\n    _tryEncodeBody(args) {\n        var _a;\n        const win = (0, SafeJs_1._getWindowSafe)();\n        const body = args.body;\n        if (!args.isStatsigEncodable ||\n            this._options.disableStatsigEncoding ||\n            typeof body !== 'string' ||\n            (0, __StatsigGlobal_1._getStatsigGlobalFlag)('no-encode') != null ||\n            !(win === null || win === void 0 ? void 0 : win.btoa)) {\n            return;\n        }\n        try {\n            args.body = win.btoa(body).split('').reverse().join('');\n            args.params = Object.assign(Object.assign({}, ((_a = args.params) !== null && _a !== void 0 ? _a : {})), { [NetworkConfig_1.NetworkParam.StatsigEncoded]: '1' });\n        }\n        catch (e) {\n            Log_1.Log.warn(`Request encoding failed for ${args.urlConfig.getUrl()}`, e);\n        }\n    }\n    _tryToCompressBody(args) {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            const body = args.body;\n            if (typeof body !== 'string' || !_allowCompression(args, this._options)) {\n                return;\n            }\n            try {\n                const bytes = new TextEncoder().encode(body);\n                const stream = new CompressionStream('gzip');\n                const writer = stream.writable.getWriter();\n                writer.write(bytes).catch(Log_1.Log.error);\n                writer.close().catch(Log_1.Log.error);\n                const reader = stream.readable.getReader();\n                const chunks = [];\n                let result;\n                // eslint-disable-next-line no-await-in-loop\n                while (!(result = yield reader.read()).done) {\n                    chunks.push(result.value);\n                }\n                const totalLength = chunks.reduce((acc, chunk) => acc + chunk.length, 0);\n                const combined = new Uint8Array(totalLength);\n                let offset = 0;\n                for (const chunk of chunks) {\n                    combined.set(chunk, offset);\n                    offset += chunk.length;\n                }\n                args.body = combined;\n                args.params = Object.assign(Object.assign({}, ((_a = args.params) !== null && _a !== void 0 ? _a : {})), { [NetworkConfig_1.NetworkParam.IsGzipped]: '1' });\n            }\n            catch (e) {\n                Log_1.Log.warn(`Request compression failed for ${args.urlConfig.getUrl()}`, e);\n            }\n        });\n    }\n    _getInternalRequestArgs(method, args) {\n        const fallbackUrl = this._fallbackResolver.getActiveFallbackUrl(args.sdkKey, args.urlConfig);\n        const result = Object.assign(Object.assign({}, args), { method,\n            fallbackUrl });\n        if ('data' in args) {\n            _populateRequestBody(result, args.data);\n        }\n        return result;\n    }\n}\nexports.NetworkCore = NetworkCore;\nconst _ensureValidSdkKey = (args) => {\n    if (!args.sdkKey) {\n        Log_1.Log.warn('Unable to make request without an SDK key');\n        return false;\n    }\n    return true;\n};\nconst _populateRequestBody = (args, data) => {\n    const { sdkKey, fallbackUrl } = args;\n    const stableID = StableID_1.StableID.get(sdkKey);\n    const sessionID = SessionID_1.SessionID.get(sdkKey);\n    const sdkType = SDKType_1.SDKType._get(sdkKey);\n    args.body = JSON.stringify(Object.assign(Object.assign({}, data), { statsigMetadata: Object.assign(Object.assign({}, StatsigMetadata_1.StatsigMetadataProvider.get()), { stableID,\n            sessionID,\n            sdkType,\n            fallbackUrl }) }));\n};\nfunction _allowCompression(args, options) {\n    if (!args.isCompressable) {\n        return false;\n    }\n    // Never compress if 'no-compress' is set globally or required APIs are unavailable\n    if ((0, __StatsigGlobal_1._getStatsigGlobalFlag)('no-compress') != null ||\n        typeof CompressionStream === 'undefined' ||\n        typeof TextEncoder === 'undefined') {\n        return false;\n    }\n    const isProxy = args.urlConfig.customUrl != null || args.urlConfig.fallbackUrls != null;\n    const flagEnabled = SDKFlags_1.SDKFlags.get(args.sdkKey, 'enable_log_event_compression') === true;\n    switch (options.logEventCompressionMode) {\n        case StatsigOptionsCommon_1.LogEventCompressionMode.Disabled:\n            return false;\n        case StatsigOptionsCommon_1.LogEventCompressionMode.Enabled:\n            // Only compress through proxy if flag is explicitly on\n            if (isProxy && !flagEnabled) {\n                return false;\n            }\n            return true;\n        case StatsigOptionsCommon_1.LogEventCompressionMode.Forced:\n            return true;\n        default:\n            return false;\n    }\n}\nfunction _getErrorMessage(error) {\n    if (typeof error === 'string') {\n        return error;\n    }\n    if (error instanceof Error) {\n        return `${error.name}: ${error.message}`;\n    }\n    return 'Unknown Error';\n}\nfunction _didTimeout(errorMsg, abortedByTimeout) {\n    const timeout = errorMsg.includes('Timeout'); // probably not needed but just in case\n    return timeout || abortedByTimeout;\n}\nfunction _tryMarkInitStart(args, attempt) {\n    if (args.urlConfig.endpoint !== NetworkConfig_1.Endpoint._initialize) {\n        return;\n    }\n    Diagnostics_1.Diagnostics._markInitNetworkReqStart(args.sdkKey, {\n        attempt,\n    });\n}\nfunction _tryMarkInitEnd(args, response, attempt, body, err) {\n    if (args.urlConfig.endpoint !== NetworkConfig_1.Endpoint._initialize) {\n        return;\n    }\n    Diagnostics_1.Diagnostics._markInitNetworkReqEnd(args.sdkKey, Diagnostics_1.Diagnostics._getDiagnosticsData(response, attempt, body, err));\n}\nfunction _exponentialBackoff(attempt) {\n    return __awaiter(this, void 0, void 0, function* () {\n        // 1*1*1000 1s\n        // 2*2*1000 4s\n        // 3*3*1000 9s\n        // 4*4*1000 16s\n        // 5*5*1000 25s\n        yield new Promise((r) => setTimeout(r, Math.min(BACKOFF_BASE_MS * (attempt * attempt), BACKOFF_MAX_MS)));\n    });\n}\n"],"mappings":"AAAA,YAAY;;AACZ,IAAIA,SAAS,GAAI,IAAI,IAAI,IAAI,CAACA,SAAS,IAAK,UAAUC,OAAO,EAAEC,UAAU,EAAEC,CAAC,EAAEC,SAAS,EAAE;EACrF,SAASC,KAAKA,CAACC,KAAK,EAAE;IAAE,OAAOA,KAAK,YAAYH,CAAC,GAAGG,KAAK,GAAG,IAAIH,CAAC,CAAC,UAAUI,OAAO,EAAE;MAAEA,OAAO,CAACD,KAAK,CAAC;IAAE,CAAC,CAAC;EAAE;EAC3G,OAAO,KAAKH,CAAC,KAAKA,CAAC,GAAGK,OAAO,CAAC,EAAE,UAAUD,OAAO,EAAEE,MAAM,EAAE;IACvD,SAASC,SAASA,CAACJ,KAAK,EAAE;MAAE,IAAI;QAAEK,IAAI,CAACP,SAAS,CAACQ,IAAI,CAACN,KAAK,CAAC,CAAC;MAAE,CAAC,CAAC,OAAOO,CAAC,EAAE;QAAEJ,MAAM,CAACI,CAAC,CAAC;MAAE;IAAE;IAC1F,SAASC,QAAQA,CAACR,KAAK,EAAE;MAAE,IAAI;QAAEK,IAAI,CAACP,SAAS,CAAC,OAAO,CAAC,CAACE,KAAK,CAAC,CAAC;MAAE,CAAC,CAAC,OAAOO,CAAC,EAAE;QAAEJ,MAAM,CAACI,CAAC,CAAC;MAAE;IAAE;IAC7F,SAASF,IAAIA,CAACI,MAAM,EAAE;MAAEA,MAAM,CAACC,IAAI,GAAGT,OAAO,CAACQ,MAAM,CAACT,KAAK,CAAC,GAAGD,KAAK,CAACU,MAAM,CAACT,KAAK,CAAC,CAACW,IAAI,CAACP,SAAS,EAAEI,QAAQ,CAAC;IAAE;IAC7GH,IAAI,CAAC,CAACP,SAAS,GAAGA,SAAS,CAACc,KAAK,CAACjB,OAAO,EAAEC,UAAU,IAAI,EAAE,CAAC,EAAEU,IAAI,CAAC,CAAC,CAAC;EACzE,CAAC,CAAC;AACN,CAAC;AACDO,MAAM,CAACC,cAAc,CAACC,OAAO,EAAE,YAAY,EAAE;EAAEf,KAAK,EAAE;AAAK,CAAC,CAAC;AAC7De,OAAO,CAACC,WAAW,GAAG,KAAK,CAAC;AAC5BC,OAAO,CAAC,mBAAmB,CAAC;AAC5B,MAAMC,iBAAiB,GAAGD,OAAO,CAAC,mBAAmB,CAAC;AACtD,MAAME,aAAa,GAAGF,OAAO,CAAC,eAAe,CAAC;AAC9C,MAAMG,KAAK,GAAGH,OAAO,CAAC,OAAO,CAAC;AAC9B,MAAMI,eAAe,GAAGJ,OAAO,CAAC,iBAAiB,CAAC;AAClD,MAAMK,yBAAyB,GAAGL,OAAO,CAAC,2BAA2B,CAAC;AACtE,MAAMM,UAAU,GAAGN,OAAO,CAAC,YAAY,CAAC;AACxC,MAAMO,SAAS,GAAGP,OAAO,CAAC,WAAW,CAAC;AACtC,MAAMQ,QAAQ,GAAGR,OAAO,CAAC,UAAU,CAAC;AACpC,MAAMS,WAAW,GAAGT,OAAO,CAAC,aAAa,CAAC;AAC1C,MAAMU,UAAU,GAAGV,OAAO,CAAC,YAAY,CAAC;AACxC,MAAMW,2BAA2B,GAAGX,OAAO,CAAC,6BAA6B,CAAC;AAC1E,MAAMY,iBAAiB,GAAGZ,OAAO,CAAC,mBAAmB,CAAC;AACtD,MAAMa,sBAAsB,GAAGb,OAAO,CAAC,wBAAwB,CAAC;AAChE,MAAMc,qBAAqB,GAAGd,OAAO,CAAC,uBAAuB,CAAC;AAC9D,MAAMe,kBAAkB,GAAG,KAAK;AAChC,MAAMC,eAAe,GAAG,GAAG;AAC3B,MAAMC,cAAc,GAAG,KAAK;AAC5B,MAAMC,oBAAoB,GAAG,IAAI;AACjC,MAAMC,wBAAwB,GAAG,EAAE;AACnC,MAAMC,SAAS,GAAGD,wBAAwB,GAAGD,oBAAoB;AACjE,MAAMG,eAAe,GAAG,IAAIC,GAAG,CAAC,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC;AACzE,MAAMvB,WAAW,CAAC;EACdwB,WAAWA,CAACC,OAAO,EAAEC,QAAQ,EAAE;IAC3B,IAAI,CAACA,QAAQ,GAAGA,QAAQ;IACxB,IAAI,CAACC,cAAc,GAAG,IAAI;IAC1B,IAAI,CAACC,QAAQ,GAAGZ,kBAAkB;IAClC,IAAI,CAACa,UAAU,GAAG,CAAC,CAAC;IACpB,IAAI,CAACC,QAAQ,GAAG,CAAC,CAAC;IAClB,IAAI,CAACC,YAAY,GAAG,CAAC,CAAC;IACtB,IAAI,CAACC,gBAAgB,GAAG,IAAI;IAC5B,IAAIP,OAAO,EAAE;MACT,IAAI,CAACK,QAAQ,GAAGL,OAAO;IAC3B;IACA,IAAI,IAAI,CAACK,QAAQ,CAACG,aAAa,EAAE;MAC7B,IAAI,CAACJ,UAAU,GAAG,IAAI,CAACC,QAAQ,CAACG,aAAa;IACjD;IACA,IAAI,IAAI,CAACJ,UAAU,CAACK,gBAAgB,EAAE;MAClC,IAAI,CAACN,QAAQ,GAAG,IAAI,CAACC,UAAU,CAACK,gBAAgB;IACpD;IACA,IAAI,CAACC,iBAAiB,GAAG,IAAI7B,yBAAyB,CAAC8B,uBAAuB,CAAC,IAAI,CAACN,QAAQ,CAAC;IAC7F,IAAI,CAACO,0BAA0B,CAAC,IAAI,CAACC,2BAA2B,CAACb,OAAO,CAAC,CAAC;EAC9E;EACAY,0BAA0BA,CAACE,IAAI,EAAE;IAC7B,IAAI,CAACT,QAAQ,CAACU,uBAAuB,GAAGD,IAAI;EAChD;EACAE,gBAAgBA,CAACC,aAAa,EAAE;IAC5B,IAAI,CAACf,cAAc,GAAGe,aAAa;IACnC,IAAI,CAACf,cAAc,CAACgB,IAAI,CAAC,IAAI,CAAC;IAC9B,IAAI,CAAChB,cAAc,CAACgB,IAAI,CAAC,IAAI,CAACR,iBAAiB,CAAC;IAChD,IAAI,CAACA,iBAAiB,CAACM,gBAAgB,CAACC,aAAa,CAAC;EAC1D;EACAE,iBAAiBA,CAAA,EAAG;IAChB,OAAQ,OAAOC,SAAS,KAAK,WAAW,IACpC,OAAOA,SAAS,CAACC,UAAU,KAAK,UAAU;EAClD;EACAC,0BAA0BA,CAAA,EAAG;IACzB,MAAMC,OAAO,GAAG,IAAI,CAAChB,gBAAgB;IACrC,IAAI,CAACA,gBAAgB,GAAG,IAAI;IAC5B,OAAOgB,OAAO;EAClB;EACAC,MAAMA,CAACC,IAAI,EAAE;IACT,IAAI,CAACC,kBAAkB,CAACD,IAAI,CAAC,EAAE;MAC3B,OAAO,KAAK;IAChB;IACA,MAAME,YAAY,GAAG,IAAI,CAACC,uBAAuB,CAAC,MAAM,EAAEH,IAAI,CAAC;IAC/D,MAAMI,GAAG,GAAG,IAAI,CAACC,gBAAgB,CAACH,YAAY,CAAC;IAC/C,MAAMI,GAAG,GAAGX,SAAS;IACrB,OAAOW,GAAG,CAACV,UAAU,CAACW,IAAI,CAACD,GAAG,CAAC,CAACF,GAAG,EAAEF,YAAY,CAACM,IAAI,CAAC;EAC3D;EACAC,IAAIA,CAACT,IAAI,EAAE;IACP,OAAOxE,SAAS,CAAC,IAAI,EAAE,KAAK,CAAC,EAAE,KAAK,CAAC,EAAE,aAAa;MAChD,MAAM0E,YAAY,GAAG,IAAI,CAACC,uBAAuB,CAAC,MAAM,EAAEH,IAAI,CAAC;MAC/D,IAAI,CAACU,cAAc,CAACR,YAAY,CAAC;MACjC,MAAM,IAAI,CAACS,kBAAkB,CAACT,YAAY,CAAC;MAC3C,OAAO,IAAI,CAACU,YAAY,CAACV,YAAY,CAAC;IAC1C,CAAC,CAAC;EACN;EACAW,GAAGA,CAACb,IAAI,EAAE;IACN,MAAME,YAAY,GAAG,IAAI,CAACC,uBAAuB,CAAC,KAAK,EAAEH,IAAI,CAAC;IAC9D,OAAO,IAAI,CAACY,YAAY,CAACV,YAAY,CAAC;EAC1C;EACAU,YAAYA,CAACZ,IAAI,EAAE;IACf,OAAOxE,SAAS,CAAC,IAAI,EAAE,KAAK,CAAC,EAAE,KAAK,CAAC,EAAE,aAAa;MAChD,IAAIsF,EAAE,EAAEC,EAAE,EAAEC,EAAE,EAAEC,EAAE;MAClB,IAAI,CAAChB,kBAAkB,CAACD,IAAI,CAAC,EAAE;QAC3B,OAAO,IAAI;MACf;MACA,IAAI,IAAI,CAACrB,UAAU,CAACuC,wBAAwB,EAAE;QAC1C,OAAO,IAAI;MACf;MACA,MAAM;QAAEC,MAAM;QAAEX,IAAI;QAAEY,OAAO;QAAEC;MAAQ,CAAC,GAAGrB,IAAI;MAC/C,MAAMsB,QAAQ,GAAGtB,IAAI,CAACuB,SAAS,CAACD,QAAQ;MACxC,IAAI,IAAI,CAACE,cAAc,CAACF,QAAQ,CAAC,EAAE;QAC/BpE,KAAK,CAACuE,GAAG,CAACC,IAAI,CAAC,cAAcJ,QAAQ,8DAA8D,CAAC;QACpG,OAAO,IAAI;MACf;MACA,MAAMK,cAAc,GAAGN,OAAO,KAAK,IAAI,IAAIA,OAAO,KAAK,KAAK,CAAC,GAAGA,OAAO,GAAG,CAAC;MAC3E,IAAIO,WAAW,GAAG,KAAK;MACvB,MAAMC,YAAY,GAAG,IAAI,CAACxB,gBAAgB,CAACL,IAAI,CAAC;MAChD,IAAI8B,QAAQ,GAAG,IAAI;MACnB,MAAMC,SAAS,GAAG,CAAC,CAAC,EAAElE,qBAAqB,CAACmE,YAAY,EAAE,CAAC;MAC3D,IAAI;QACA,MAAMC,MAAM,GAAG;UACXd,MAAM;UACNX,IAAI;UACJ0B,OAAO,EAAEvF,MAAM,CAACwF,MAAM,CAAC,CAAC,CAAC,EAAEnC,IAAI,CAACkC,OAAO,CAAC;UACxCE,QAAQ,EAAEpC,IAAI,CAACoC,QAAQ;UACvBL;QACJ,CAAC;QACDM,iBAAiB,CAACrC,IAAI,EAAE2B,cAAc,CAAC;QACvC,MAAMW,MAAM,GAAG,IAAI,CAACzD,YAAY,CAACyC,QAAQ,CAAC;QAC1C,IAAIgB,MAAM,EAAE;UACRA,MAAM,CAACC,eAAe,GAAGC,IAAI,CAACC,GAAG,CAAC,CAAC;UACnC,IAAI,CAAC5D,YAAY,CAACyC,QAAQ,CAAC,GAAGgB,MAAM;QACxC;QACA,MAAMI,IAAI,GAAG,CAAC5B,EAAE,GAAG,IAAI,CAACnC,UAAU,CAACgE,mBAAmB,MAAM,IAAI,IAAI7B,EAAE,KAAK,KAAK,CAAC,GAAGA,EAAE,GAAG8B,KAAK;QAC9F,IAAIC,SAAS;QACbf,QAAQ,GAAG,MAAM9F,OAAO,CAAC8G,IAAI,CAAC,CAC1BJ,IAAI,CAACb,YAAY,EAAEI,MAAM,CAAC,CAACc,OAAO,CAAC,MAAMC,YAAY,CAACH,SAAS,CAAC,CAAC,EACjE,IAAI7G,OAAO,CAAC,CAACiH,CAAC,EAAEhH,MAAM,KAAK;UACvB4G,SAAS,GAAGK,UAAU,CAAC,MAAM;YACzBtB,WAAW,GAAG,IAAI;YAClB3F,MAAM,CAAC,IAAIkH,KAAK,CAAC,cAAc,IAAI,CAACzE,QAAQ,aAAa,CAAC,CAAC;UAC/D,CAAC,EAAE,IAAI,CAACA,QAAQ,CAAC;QACrB,CAAC,CAAC,CACL,CAAC;QACF,IAAI,CAACoD,QAAQ,CAACsB,EAAE,EAAE;UACd,MAAMC,IAAI,GAAG,MAAMvB,QAAQ,CAACuB,IAAI,CAAC,CAAC,CAACC,KAAK,CAAC,MAAM,SAAS,CAAC;UACzD,MAAMC,GAAG,GAAG,IAAIJ,KAAK,CAAC,iBAAiBtB,YAAY,IAAIwB,IAAI,EAAE,CAAC;UAC9DE,GAAG,CAACC,IAAI,GAAG,cAAc;UACzB,MAAMD,GAAG;QACb;QACA,MAAMF,IAAI,GAAG,MAAMvB,QAAQ,CAACuB,IAAI,CAAC,CAAC;QAClCI,eAAe,CAACzD,IAAI,EAAE8B,QAAQ,EAAEH,cAAc,EAAE0B,IAAI,CAAC;QACrD,IAAI,CAACpE,iBAAiB,CAACyE,iBAAiB,CAAC1D,IAAI,CAAC2D,MAAM,EAAE3D,IAAI,CAACuB,SAAS,CAAC;QACrE,OAAO;UACHf,IAAI,EAAE6C,IAAI;UACVO,IAAI,EAAE9B,QAAQ,CAAC+B;QACnB,CAAC;MACL,CAAC,CACD,OAAOC,KAAK,EAAE;QACV,MAAMC,YAAY,GAAGC,gBAAgB,CAACF,KAAK,CAAC;QAC5C,MAAMG,QAAQ,GAAGC,WAAW,CAACH,YAAY,KAAK,IAAI,IAAIA,YAAY,KAAK,KAAK,CAAC,GAAGA,YAAY,GAAG,EAAE,EAAEnC,WAAW,CAAC;QAC/G6B,eAAe,CAACzD,IAAI,EAAE8B,QAAQ,EAAEH,cAAc,EAAE,EAAE,EAAEmC,KAAK,CAAC;QAC1D,MAAMK,eAAe,GAAG,MAAM,IAAI,CAAClF,iBAAiB,CAACmF,2BAA2B,CAACpE,IAAI,CAAC2D,MAAM,EAAE3D,IAAI,CAACuB,SAAS,EAAEwC,YAAY,EAAEE,QAAQ,CAAC;QACrI,IAAIE,eAAe,EAAE;UACjBnE,IAAI,CAACqE,WAAW,GAAG,IAAI,CAACpF,iBAAiB,CAACqF,oBAAoB,CAACtE,IAAI,CAAC2D,MAAM,EAAE3D,IAAI,CAACuB,SAAS,CAAC;QAC/F;QACA,IAAI,CAACH,OAAO,IACRO,cAAc,GAAGP,OAAO,IACxB,CAAChD,eAAe,CAACmG,GAAG,CAAC,CAACxD,EAAE,GAAGe,QAAQ,KAAK,IAAI,IAAIA,QAAQ,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,QAAQ,CAAC+B,MAAM,MAAM,IAAI,IAAI9C,EAAE,KAAK,KAAK,CAAC,GAAGA,EAAE,GAAG,GAAG,CAAC,EAAE;UACvI,CAACC,EAAE,GAAG,IAAI,CAACxC,QAAQ,MAAM,IAAI,IAAIwC,EAAE,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,EAAE,CAACwD,IAAI,CAAC,IAAI,EAAE;YACpEhB,IAAI,EAAE,OAAO;YACbM,KAAK;YACLW,GAAG,EAAE/G,2BAA2B,CAACgH,QAAQ,CAACC,YAAY;YACtDC,WAAW,EAAE5E;UACjB,CAAC,CAAC;UACF,MAAM6E,iBAAiB,GAAG,sCAAsC1D,MAAM,eAAeU,YAAY,GAAG;UACpG3E,KAAK,CAACuE,GAAG,CAACqC,KAAK,CAACe,iBAAiB,EAAEd,YAAY,EAAED,KAAK,CAAC;UACvD,CAAC7C,EAAE,GAAG,IAAI,CAACxC,cAAc,MAAM,IAAI,IAAIwC,EAAE,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,EAAE,CAAC6D,uBAAuB,CAACD,iBAAiB,CAAC;UAC7G,OAAO,IAAI;QACf;QACA,MAAME,mBAAmB,CAACpD,cAAc,CAAC;QACzC,OAAO,IAAI,CAACf,YAAY,CAACjE,MAAM,CAACwF,MAAM,CAACxF,MAAM,CAACwF,MAAM,CAAC,CAAC,CAAC,EAAEnC,IAAI,CAAC,EAAE;UAAEoB,OAAO;UAAEC,OAAO,EAAEM,cAAc,GAAG;QAAE,CAAC,CAAC,CAAC;MAC9G;IACJ,CAAC,CAAC;EACN;EACAvC,2BAA2BA,CAACb,OAAO,EAAE;IACjC;IACA,IAAIyG,eAAe,GAAGzG,OAAO,KAAK,IAAI,IAAIA,OAAO,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,OAAO,CAACe,uBAAuB;IACvG,IAAI,CAAC0F,eAAe,IAAI,CAACzG,OAAO,KAAK,IAAI,IAAIA,OAAO,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,OAAO,CAAC0G,kBAAkB,MAAM,IAAI,EAAE;MAC7GD,eAAe,GAAGpH,sBAAsB,CAACsH,uBAAuB,CAACC,QAAQ;IAC7E;IACA;IACA,IAAI,CAACH,eAAe,EAAE;MAClBA,eAAe,GAAGpH,sBAAsB,CAACsH,uBAAuB,CAACE,OAAO;IAC5E;IACA,OAAOJ,eAAe;EAC1B;EACAxD,cAAcA,CAACF,QAAQ,EAAE;IACrB,IAAIR,EAAE;IACN,MAAM2B,GAAG,GAAGD,IAAI,CAACC,GAAG,CAAC,CAAC;IACtB,MAAMH,MAAM,GAAG,CAACxB,EAAE,GAAG,IAAI,CAACjC,YAAY,CAACyC,QAAQ,CAAC,MAAM,IAAI,IAAIR,EAAE,KAAK,KAAK,CAAC,GAAGA,EAAE,GAAG;MAC/EuE,KAAK,EAAE,CAAC;MACR9C,eAAe,EAAEE;IACrB,CAAC;IACD,MAAM6C,OAAO,GAAG7C,GAAG,GAAGH,MAAM,CAACC,eAAe;IAC5C,MAAMgD,cAAc,GAAGC,IAAI,CAACC,KAAK,CAACH,OAAO,GAAGnH,SAAS,CAAC;IACtDmE,MAAM,CAAC+C,KAAK,GAAGG,IAAI,CAACE,GAAG,CAAC,CAAC,EAAEpD,MAAM,CAAC+C,KAAK,GAAGE,cAAc,CAAC;IACzD,IAAIjD,MAAM,CAAC+C,KAAK,IAAInH,wBAAwB,EAAE;MAC1C,OAAO,IAAI;IACf;IACAoE,MAAM,CAAC+C,KAAK,IAAI,CAAC;IACjB/C,MAAM,CAACC,eAAe,GAAGE,GAAG;IAC5B,IAAI,CAAC5D,YAAY,CAACyC,QAAQ,CAAC,GAAGgB,MAAM;IACpC,OAAO,KAAK;EAChB;EACAjC,gBAAgBA,CAACL,IAAI,EAAE;IACnB,IAAIc,EAAE;IACN,MAAMV,GAAG,GAAG,CAACU,EAAE,GAAGd,IAAI,CAACqE,WAAW,MAAM,IAAI,IAAIvD,EAAE,KAAK,KAAK,CAAC,GAAGA,EAAE,GAAGd,IAAI,CAACuB,SAAS,CAACoE,MAAM,CAAC,CAAC;IAC5F,IAAI3F,IAAI,CAACuB,SAAS,CAACD,QAAQ,KAAKnE,eAAe,CAACyI,QAAQ,CAACC,WAAW,IAChE7F,IAAI,CAACuB,SAAS,CAACD,QAAQ,KAAKnE,eAAe,CAACyI,QAAQ,CAACE,sBAAsB,EAAE;MAC7E,IAAI,CAAChH,gBAAgB,GAAGsB,GAAG;IAC/B;IACA,MAAM2F,MAAM,GAAGpJ,MAAM,CAACwF,MAAM,CAAC;MAAE,CAAChF,eAAe,CAAC6I,YAAY,CAACC,MAAM,GAAGjG,IAAI,CAAC2D,MAAM;MAAE,CAACxG,eAAe,CAAC6I,YAAY,CAACE,OAAO,GAAG5I,SAAS,CAAC6I,OAAO,CAACC,IAAI,CAACpG,IAAI,CAAC2D,MAAM,CAAC;MAAE,CAACxG,eAAe,CAAC6I,YAAY,CAACK,UAAU,GAAG1I,iBAAiB,CAAC2I,WAAW;MAAE,CAACnJ,eAAe,CAAC6I,YAAY,CAACO,IAAI,GAAGC,MAAM,CAAChE,IAAI,CAACC,GAAG,CAAC,CAAC,CAAC;MAAE,CAACtF,eAAe,CAAC6I,YAAY,CAACS,SAAS,GAAGjJ,WAAW,CAACiJ,SAAS,CAAC5F,GAAG,CAACb,IAAI,CAAC2D,MAAM;IAAE,CAAC,EAAE3D,IAAI,CAAC+F,MAAM,CAAC;IACnY,MAAMW,KAAK,GAAG/J,MAAM,CAACgK,IAAI,CAACZ,MAAM,CAAC,CAC5Ba,GAAG,CAAEC,GAAG,IAAK;MACd,OAAO,GAAGC,kBAAkB,CAACD,GAAG,CAAC,IAAIC,kBAAkB,CAACf,MAAM,CAACc,GAAG,CAAC,CAAC,EAAE;IAC1E,CAAC,CAAC,CACGE,IAAI,CAAC,GAAG,CAAC;IACd,OAAO,GAAG3G,GAAG,GAAGsG,KAAK,GAAG,IAAIA,KAAK,EAAE,GAAG,EAAE,EAAE;EAC9C;EACAhG,cAAcA,CAACV,IAAI,EAAE;IACjB,IAAIc,EAAE;IACN,MAAMkG,GAAG,GAAG,CAAC,CAAC,EAAEzJ,QAAQ,CAAC0J,cAAc,EAAE,CAAC;IAC1C,MAAMzG,IAAI,GAAGR,IAAI,CAACQ,IAAI;IACtB,IAAI,CAACR,IAAI,CAACkH,kBAAkB,IACxB,IAAI,CAACtI,QAAQ,CAACuI,sBAAsB,IACpC,OAAO3G,IAAI,KAAK,QAAQ,IACxB,CAAC,CAAC,EAAExD,iBAAiB,CAACoK,qBAAqB,EAAE,WAAW,CAAC,IAAI,IAAI,IACjE,EAAEJ,GAAG,KAAK,IAAI,IAAIA,GAAG,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,GAAG,CAACK,IAAI,CAAC,EAAE;MACvD;IACJ;IACA,IAAI;MACArH,IAAI,CAACQ,IAAI,GAAGwG,GAAG,CAACK,IAAI,CAAC7G,IAAI,CAAC,CAAC8G,KAAK,CAAC,EAAE,CAAC,CAACC,OAAO,CAAC,CAAC,CAACR,IAAI,CAAC,EAAE,CAAC;MACvD/G,IAAI,CAAC+F,MAAM,GAAGpJ,MAAM,CAACwF,MAAM,CAACxF,MAAM,CAACwF,MAAM,CAAC,CAAC,CAAC,EAAG,CAACrB,EAAE,GAAGd,IAAI,CAAC+F,MAAM,MAAM,IAAI,IAAIjF,EAAE,KAAK,KAAK,CAAC,GAAGA,EAAE,GAAG,CAAC,CAAE,CAAC,EAAE;QAAE,CAAC3D,eAAe,CAAC6I,YAAY,CAACwB,cAAc,GAAG;MAAI,CAAC,CAAC;IACpK,CAAC,CACD,OAAOnL,CAAC,EAAE;MACNa,KAAK,CAACuE,GAAG,CAACC,IAAI,CAAC,+BAA+B1B,IAAI,CAACuB,SAAS,CAACoE,MAAM,CAAC,CAAC,EAAE,EAAEtJ,CAAC,CAAC;IAC/E;EACJ;EACAsE,kBAAkBA,CAACX,IAAI,EAAE;IACrB,OAAOxE,SAAS,CAAC,IAAI,EAAE,KAAK,CAAC,EAAE,KAAK,CAAC,EAAE,aAAa;MAChD,IAAIsF,EAAE;MACN,MAAMN,IAAI,GAAGR,IAAI,CAACQ,IAAI;MACtB,IAAI,OAAOA,IAAI,KAAK,QAAQ,IAAI,CAACiH,iBAAiB,CAACzH,IAAI,EAAE,IAAI,CAACpB,QAAQ,CAAC,EAAE;QACrE;MACJ;MACA,IAAI;QACA,MAAM8I,KAAK,GAAG,IAAIC,WAAW,CAAC,CAAC,CAACC,MAAM,CAACpH,IAAI,CAAC;QAC5C,MAAMqH,MAAM,GAAG,IAAIC,iBAAiB,CAAC,MAAM,CAAC;QAC5C,MAAMC,MAAM,GAAGF,MAAM,CAACG,QAAQ,CAACC,SAAS,CAAC,CAAC;QAC1CF,MAAM,CAACG,KAAK,CAACR,KAAK,CAAC,CAACpE,KAAK,CAACpG,KAAK,CAACuE,GAAG,CAACqC,KAAK,CAAC;QAC1CiE,MAAM,CAACI,KAAK,CAAC,CAAC,CAAC7E,KAAK,CAACpG,KAAK,CAACuE,GAAG,CAACqC,KAAK,CAAC;QACrC,MAAMsE,MAAM,GAAGP,MAAM,CAACQ,QAAQ,CAACC,SAAS,CAAC,CAAC;QAC1C,MAAMC,MAAM,GAAG,EAAE;QACjB,IAAIhM,MAAM;QACV;QACA,OAAO,CAAC,CAACA,MAAM,GAAG,MAAM6L,MAAM,CAACI,IAAI,CAAC,CAAC,EAAEhM,IAAI,EAAE;UACzC+L,MAAM,CAACE,IAAI,CAAClM,MAAM,CAACT,KAAK,CAAC;QAC7B;QACA,MAAM4M,WAAW,GAAGH,MAAM,CAACI,MAAM,CAAC,CAACC,GAAG,EAAEC,KAAK,KAAKD,GAAG,GAAGC,KAAK,CAACC,MAAM,EAAE,CAAC,CAAC;QACxE,MAAMC,QAAQ,GAAG,IAAIC,UAAU,CAACN,WAAW,CAAC;QAC5C,IAAIO,MAAM,GAAG,CAAC;QACd,KAAK,MAAMJ,KAAK,IAAIN,MAAM,EAAE;UACxBQ,QAAQ,CAACG,GAAG,CAACL,KAAK,EAAEI,MAAM,CAAC;UAC3BA,MAAM,IAAIJ,KAAK,CAACC,MAAM;QAC1B;QACA9I,IAAI,CAACQ,IAAI,GAAGuI,QAAQ;QACpB/I,IAAI,CAAC+F,MAAM,GAAGpJ,MAAM,CAACwF,MAAM,CAACxF,MAAM,CAACwF,MAAM,CAAC,CAAC,CAAC,EAAG,CAACrB,EAAE,GAAGd,IAAI,CAAC+F,MAAM,MAAM,IAAI,IAAIjF,EAAE,KAAK,KAAK,CAAC,GAAGA,EAAE,GAAG,CAAC,CAAE,CAAC,EAAE;UAAE,CAAC3D,eAAe,CAAC6I,YAAY,CAACmD,SAAS,GAAG;QAAI,CAAC,CAAC;MAC/J,CAAC,CACD,OAAO9M,CAAC,EAAE;QACNa,KAAK,CAACuE,GAAG,CAACC,IAAI,CAAC,kCAAkC1B,IAAI,CAACuB,SAAS,CAACoE,MAAM,CAAC,CAAC,EAAE,EAAEtJ,CAAC,CAAC;MAClF;IACJ,CAAC,CAAC;EACN;EACA8D,uBAAuBA,CAACgB,MAAM,EAAEnB,IAAI,EAAE;IAClC,MAAMqE,WAAW,GAAG,IAAI,CAACpF,iBAAiB,CAACqF,oBAAoB,CAACtE,IAAI,CAAC2D,MAAM,EAAE3D,IAAI,CAACuB,SAAS,CAAC;IAC5F,MAAMhF,MAAM,GAAGI,MAAM,CAACwF,MAAM,CAACxF,MAAM,CAACwF,MAAM,CAAC,CAAC,CAAC,EAAEnC,IAAI,CAAC,EAAE;MAAEmB,MAAM;MAC1DkD;IAAY,CAAC,CAAC;IAClB,IAAI,MAAM,IAAIrE,IAAI,EAAE;MAChBoJ,oBAAoB,CAAC7M,MAAM,EAAEyD,IAAI,CAACqJ,IAAI,CAAC;IAC3C;IACA,OAAO9M,MAAM;EACjB;AACJ;AACAM,OAAO,CAACC,WAAW,GAAGA,WAAW;AACjC,MAAMmD,kBAAkB,GAAID,IAAI,IAAK;EACjC,IAAI,CAACA,IAAI,CAAC2D,MAAM,EAAE;IACdzG,KAAK,CAACuE,GAAG,CAACC,IAAI,CAAC,2CAA2C,CAAC;IAC3D,OAAO,KAAK;EAChB;EACA,OAAO,IAAI;AACf,CAAC;AACD,MAAM0H,oBAAoB,GAAGA,CAACpJ,IAAI,EAAEqJ,IAAI,KAAK;EACzC,MAAM;IAAE1F,MAAM;IAAEU;EAAY,CAAC,GAAGrE,IAAI;EACpC,MAAMsJ,QAAQ,GAAG7L,UAAU,CAAC8L,QAAQ,CAAC1I,GAAG,CAAC8C,MAAM,CAAC;EAChD,MAAM6F,SAAS,GAAGhM,WAAW,CAACiJ,SAAS,CAAC5F,GAAG,CAAC8C,MAAM,CAAC;EACnD,MAAM8F,OAAO,GAAGnM,SAAS,CAAC6I,OAAO,CAACC,IAAI,CAACzC,MAAM,CAAC;EAC9C3D,IAAI,CAACQ,IAAI,GAAGkJ,IAAI,CAACC,SAAS,CAAChN,MAAM,CAACwF,MAAM,CAACxF,MAAM,CAACwF,MAAM,CAAC,CAAC,CAAC,EAAEkH,IAAI,CAAC,EAAE;IAAEO,eAAe,EAAEjN,MAAM,CAACwF,MAAM,CAACxF,MAAM,CAACwF,MAAM,CAAC,CAAC,CAAC,EAAExE,iBAAiB,CAACkM,uBAAuB,CAAChJ,GAAG,CAAC,CAAC,CAAC,EAAE;MAAEyI,QAAQ;MACzKE,SAAS;MACTC,OAAO;MACPpF;IAAY,CAAC;EAAE,CAAC,CAAC,CAAC;AAC9B,CAAC;AACD,SAASoD,iBAAiBA,CAACzH,IAAI,EAAEzB,OAAO,EAAE;EACtC,IAAI,CAACyB,IAAI,CAAC8J,cAAc,EAAE;IACtB,OAAO,KAAK;EAChB;EACA;EACA,IAAI,CAAC,CAAC,EAAE9M,iBAAiB,CAACoK,qBAAqB,EAAE,aAAa,CAAC,IAAI,IAAI,IACnE,OAAOU,iBAAiB,KAAK,WAAW,IACxC,OAAOH,WAAW,KAAK,WAAW,EAAE;IACpC,OAAO,KAAK;EAChB;EACA,MAAMoC,OAAO,GAAG/J,IAAI,CAACuB,SAAS,CAACyI,SAAS,IAAI,IAAI,IAAIhK,IAAI,CAACuB,SAAS,CAAC0I,YAAY,IAAI,IAAI;EACvF,MAAMC,WAAW,GAAG7M,UAAU,CAAC8M,QAAQ,CAACtJ,GAAG,CAACb,IAAI,CAAC2D,MAAM,EAAE,8BAA8B,CAAC,KAAK,IAAI;EACjG,QAAQpF,OAAO,CAACe,uBAAuB;IACnC,KAAK1B,sBAAsB,CAACsH,uBAAuB,CAACC,QAAQ;MACxD,OAAO,KAAK;IAChB,KAAKvH,sBAAsB,CAACsH,uBAAuB,CAACE,OAAO;MACvD;MACA,IAAI2E,OAAO,IAAI,CAACG,WAAW,EAAE;QACzB,OAAO,KAAK;MAChB;MACA,OAAO,IAAI;IACf,KAAKtM,sBAAsB,CAACsH,uBAAuB,CAACkF,MAAM;MACtD,OAAO,IAAI;IACf;MACI,OAAO,KAAK;EACpB;AACJ;AACA,SAASpG,gBAAgBA,CAACF,KAAK,EAAE;EAC7B,IAAI,OAAOA,KAAK,KAAK,QAAQ,EAAE;IAC3B,OAAOA,KAAK;EAChB;EACA,IAAIA,KAAK,YAAYX,KAAK,EAAE;IACxB,OAAO,GAAGW,KAAK,CAACN,IAAI,KAAKM,KAAK,CAACuG,OAAO,EAAE;EAC5C;EACA,OAAO,eAAe;AAC1B;AACA,SAASnG,WAAWA,CAACoG,QAAQ,EAAEC,gBAAgB,EAAE;EAC7C,MAAMC,OAAO,GAAGF,QAAQ,CAACG,QAAQ,CAAC,SAAS,CAAC,CAAC,CAAC;EAC9C,OAAOD,OAAO,IAAID,gBAAgB;AACtC;AACA,SAASlI,iBAAiBA,CAACrC,IAAI,EAAEqB,OAAO,EAAE;EACtC,IAAIrB,IAAI,CAACuB,SAAS,CAACD,QAAQ,KAAKnE,eAAe,CAACyI,QAAQ,CAACC,WAAW,EAAE;IAClE;EACJ;EACA5I,aAAa,CAACyN,WAAW,CAACC,wBAAwB,CAAC3K,IAAI,CAAC2D,MAAM,EAAE;IAC5DtC;EACJ,CAAC,CAAC;AACN;AACA,SAASoC,eAAeA,CAACzD,IAAI,EAAE8B,QAAQ,EAAET,OAAO,EAAEb,IAAI,EAAE+C,GAAG,EAAE;EACzD,IAAIvD,IAAI,CAACuB,SAAS,CAACD,QAAQ,KAAKnE,eAAe,CAACyI,QAAQ,CAACC,WAAW,EAAE;IAClE;EACJ;EACA5I,aAAa,CAACyN,WAAW,CAACE,sBAAsB,CAAC5K,IAAI,CAAC2D,MAAM,EAAE1G,aAAa,CAACyN,WAAW,CAACG,mBAAmB,CAAC/I,QAAQ,EAAET,OAAO,EAAEb,IAAI,EAAE+C,GAAG,CAAC,CAAC;AAC9I;AACA,SAASwB,mBAAmBA,CAAC1D,OAAO,EAAE;EAClC,OAAO7F,SAAS,CAAC,IAAI,EAAE,KAAK,CAAC,EAAE,KAAK,CAAC,EAAE,aAAa;IAChD;IACA;IACA;IACA;IACA;IACA,MAAM,IAAIQ,OAAO,CAAE8O,CAAC,IAAK5H,UAAU,CAAC4H,CAAC,EAAEtF,IAAI,CAACuF,GAAG,CAAChN,eAAe,IAAIsD,OAAO,GAAGA,OAAO,CAAC,EAAErD,cAAc,CAAC,CAAC,CAAC;EAC5G,CAAC,CAAC;AACN","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}