{"ast":null,"code":"\"use strict\";\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports._makeDataAdapterResult = exports.DataAdapterCore = void 0;\nconst Log_1 = require(\"./Log\");\nconst StableID_1 = require(\"./StableID\");\nconst StatsigUser_1 = require(\"./StatsigUser\");\nconst StorageProvider_1 = require(\"./StorageProvider\");\nconst TypedJsonParse_1 = require(\"./TypedJsonParse\");\nconst CACHE_LIMIT = 10;\nconst MAX_CACHE_WRITE_ATTEMPTS = 8;\nclass DataAdapterCore {\n  constructor(_adapterName, _cacheSuffix) {\n    this._adapterName = _adapterName;\n    this._cacheSuffix = _cacheSuffix;\n    this._options = null;\n    this._sdkKey = null;\n    this._cacheLimit = CACHE_LIMIT;\n    this._lastModifiedStoreKey = `statsig.last_modified_time.${_cacheSuffix}`;\n    this._inMemoryCache = new InMemoryCache();\n  }\n  attach(sdkKey, options, _network) {\n    this._sdkKey = sdkKey;\n    this._options = options;\n  }\n  getDataSync(user) {\n    const normalized = user && (0, StatsigUser_1._normalizeUser)(user, this._options);\n    const cacheKey = this._getCacheKey(normalized);\n    const inMem = this._inMemoryCache.get(cacheKey, normalized);\n    if (inMem && this._getIsCacheValueValid(inMem)) {\n      return inMem;\n    }\n    const cache = this._loadFromCache(cacheKey);\n    if (cache && this._getIsCacheValueValid(cache)) {\n      this._inMemoryCache.add(cacheKey, cache, this._cacheLimit);\n      return this._inMemoryCache.get(cacheKey, normalized);\n    }\n    return null;\n  }\n  setData(data, user) {\n    const normalized = user && (0, StatsigUser_1._normalizeUser)(user, this._options);\n    const cacheKey = this._getCacheKey(normalized);\n    this._inMemoryCache.add(cacheKey, _makeDataAdapterResult('Bootstrap', data, null, normalized), this._cacheLimit);\n  }\n  _getIsCacheValueValid(current) {\n    return current.stableID == null || current.stableID === StableID_1.StableID.get(this._getSdkKey());\n  }\n  _getDataAsyncImpl(current, user, options) {\n    return __awaiter(this, void 0, void 0, function* () {\n      if (!StorageProvider_1.Storage.isReady()) {\n        yield StorageProvider_1.Storage.isReadyResolver();\n      }\n      const cache = current !== null && current !== void 0 ? current : this.getDataSync(user);\n      const ops = [this._fetchAndPrepFromNetwork(cache, user, options)];\n      if (options === null || options === void 0 ? void 0 : options.timeoutMs) {\n        ops.push(new Promise(r => setTimeout(r, options.timeoutMs)).then(() => {\n          Log_1.Log.debug('Fetching latest value timed out');\n          return null;\n        }));\n      }\n      return yield Promise.race(ops);\n    });\n  }\n  _prefetchDataImpl(user, options) {\n    return __awaiter(this, void 0, void 0, function* () {\n      const normalized = user && (0, StatsigUser_1._normalizeUser)(user, this._options);\n      const cacheKey = this._getCacheKey(normalized);\n      const result = yield this._getDataAsyncImpl(null, normalized, options);\n      if (result) {\n        this._inMemoryCache.add(cacheKey, Object.assign(Object.assign({}, result), {\n          source: 'Prefetch'\n        }), this._cacheLimit);\n      }\n    });\n  }\n  _fetchAndPrepFromNetwork(cachedResult, user, options) {\n    return __awaiter(this, void 0, void 0, function* () {\n      var _a;\n      const cachedData = (_a = cachedResult === null || cachedResult === void 0 ? void 0 : cachedResult.data) !== null && _a !== void 0 ? _a : null;\n      const isCacheValidFor204 = cachedResult != null && this._isCachedResultValidFor204(cachedResult, user);\n      const latest = yield this._fetchFromNetwork(cachedData, user, options, isCacheValidFor204);\n      if (!latest) {\n        Log_1.Log.debug('No response returned for latest value');\n        return null;\n      }\n      const response = (0, TypedJsonParse_1._typedJsonParse)(latest, 'has_updates', 'Response');\n      const sdkKey = this._getSdkKey();\n      const stableID = StableID_1.StableID.get(sdkKey);\n      let result = null;\n      if ((response === null || response === void 0 ? void 0 : response.has_updates) === true) {\n        result = _makeDataAdapterResult('Network', latest, stableID, user);\n      } else if (cachedData && (response === null || response === void 0 ? void 0 : response.has_updates) === false) {\n        result = _makeDataAdapterResult('NetworkNotModified', cachedData, stableID, user);\n      } else {\n        return null;\n      }\n      const cacheKey = this._getCacheKey(user);\n      this._inMemoryCache.add(cacheKey, result, this._cacheLimit);\n      this._writeToCache(cacheKey, result);\n      return result;\n    });\n  }\n  _getSdkKey() {\n    if (this._sdkKey != null) {\n      return this._sdkKey;\n    }\n    Log_1.Log.error(`${this._adapterName} is not attached to a Client`);\n    return '';\n  }\n  _loadFromCache(cacheKey) {\n    var _a;\n    const cache = (_a = StorageProvider_1.Storage.getItem) === null || _a === void 0 ? void 0 : _a.call(StorageProvider_1.Storage, cacheKey);\n    if (cache == null) {\n      return null;\n    }\n    const result = (0, TypedJsonParse_1._typedJsonParse)(cache, 'source', 'Cached Result');\n    return result ? Object.assign(Object.assign({}, result), {\n      source: 'Cache'\n    }) : null;\n  }\n  _writeToCache(cacheKey, result) {\n    const resultString = JSON.stringify(result);\n    for (let i = 0; i < MAX_CACHE_WRITE_ATTEMPTS; i++) {\n      try {\n        StorageProvider_1.Storage.setItem(cacheKey, resultString);\n        break;\n      } catch (error) {\n        if (!(error instanceof Error) || !(error.toString().includes('QuotaExceededError') || error.toString().includes('QUOTA_EXCEEDED_ERR')) || this._cacheLimit <= 1) {\n          throw error;\n        }\n        this._cacheLimit = Math.ceil(this._cacheLimit / 2);\n        this._runLocalStorageCacheEviction(cacheKey, this._cacheLimit - 1);\n      }\n    }\n    this._runLocalStorageCacheEviction(cacheKey);\n  }\n  _runLocalStorageCacheEviction(cacheKey, cacheLimit = this._cacheLimit) {\n    var _a;\n    const lastModifiedTimeMap = (_a = (0, StorageProvider_1._getObjectFromStorage)(this._lastModifiedStoreKey)) !== null && _a !== void 0 ? _a : {};\n    lastModifiedTimeMap[cacheKey] = Date.now();\n    const evictableKeys = _getEvictableKeys(lastModifiedTimeMap, cacheLimit);\n    for (const evictable of evictableKeys) {\n      delete lastModifiedTimeMap[evictable];\n      StorageProvider_1.Storage.removeItem(evictable);\n    }\n    (0, StorageProvider_1._setObjectInStorage)(this._lastModifiedStoreKey, lastModifiedTimeMap);\n  }\n}\nexports.DataAdapterCore = DataAdapterCore;\nfunction _makeDataAdapterResult(source, data, stableID, user) {\n  return {\n    source,\n    data,\n    receivedAt: Date.now(),\n    stableID,\n    fullUserHash: (0, StatsigUser_1._getFullUserHash)(user)\n  };\n}\nexports._makeDataAdapterResult = _makeDataAdapterResult;\nclass InMemoryCache {\n  constructor() {\n    this._data = {};\n  }\n  get(cacheKey, user) {\n    var _a;\n    const result = this._data[cacheKey];\n    const cached = result === null || result === void 0 ? void 0 : result.stableID;\n    const provided = (_a = user === null || user === void 0 ? void 0 : user.customIDs) === null || _a === void 0 ? void 0 : _a.stableID;\n    if (provided && cached && provided !== cached) {\n      Log_1.Log.warn(\"'StatsigUser.customIDs.stableID' mismatch\");\n      return null;\n    }\n    return result;\n  }\n  add(cacheKey, value, cacheLimit) {\n    const evictableKeys = _getEvictableKeys(this._data, cacheLimit - 1);\n    for (const evictable of evictableKeys) {\n      delete this._data[evictable];\n    }\n    this._data[cacheKey] = value;\n  }\n  merge(values) {\n    this._data = Object.assign(Object.assign({}, this._data), values);\n  }\n}\nfunction _getEvictableKeys(data, limit) {\n  const keys = Object.keys(data);\n  if (keys.length <= limit) {\n    return [];\n  }\n  if (limit === 0) {\n    return keys;\n  }\n  return keys.sort((keyA, keyB) => {\n    const valueA = data[keyA];\n    const valueB = data[keyB];\n    if (typeof valueA === 'object' && typeof valueB === 'object') {\n      return valueA.receivedAt - valueB.receivedAt;\n    }\n    return valueA - valueB;\n  }).slice(0, keys.length - limit);\n}","map":{"version":3,"names":["__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","Object","defineProperty","exports","_makeDataAdapterResult","DataAdapterCore","Log_1","require","StableID_1","StatsigUser_1","StorageProvider_1","TypedJsonParse_1","CACHE_LIMIT","MAX_CACHE_WRITE_ATTEMPTS","constructor","_adapterName","_cacheSuffix","_options","_sdkKey","_cacheLimit","_lastModifiedStoreKey","_inMemoryCache","InMemoryCache","attach","sdkKey","options","_network","getDataSync","user","normalized","_normalizeUser","cacheKey","_getCacheKey","inMem","get","_getIsCacheValueValid","cache","_loadFromCache","add","setData","data","current","stableID","StableID","_getSdkKey","_getDataAsyncImpl","Storage","isReady","isReadyResolver","ops","_fetchAndPrepFromNetwork","timeoutMs","push","r","setTimeout","Log","debug","race","_prefetchDataImpl","assign","source","cachedResult","_a","cachedData","isCacheValidFor204","_isCachedResultValidFor204","latest","_fetchFromNetwork","response","_typedJsonParse","has_updates","_writeToCache","error","getItem","call","resultString","JSON","stringify","i","setItem","Error","toString","includes","Math","ceil","_runLocalStorageCacheEviction","cacheLimit","lastModifiedTimeMap","_getObjectFromStorage","Date","now","evictableKeys","_getEvictableKeys","evictable","removeItem","_setObjectInStorage","receivedAt","fullUserHash","_getFullUserHash","_data","cached","provided","customIDs","warn","merge","values","limit","keys","length","sort","keyA","keyB","valueA","valueB","slice"],"sources":["/Users/sidiq/Documents/OptiviseWeb/node_modules/@statsig/client-core/src/DataAdapterCore.js"],"sourcesContent":["\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports._makeDataAdapterResult = exports.DataAdapterCore = void 0;\nconst Log_1 = require(\"./Log\");\nconst StableID_1 = require(\"./StableID\");\nconst StatsigUser_1 = require(\"./StatsigUser\");\nconst StorageProvider_1 = require(\"./StorageProvider\");\nconst TypedJsonParse_1 = require(\"./TypedJsonParse\");\nconst CACHE_LIMIT = 10;\nconst MAX_CACHE_WRITE_ATTEMPTS = 8;\nclass DataAdapterCore {\n    constructor(_adapterName, _cacheSuffix) {\n        this._adapterName = _adapterName;\n        this._cacheSuffix = _cacheSuffix;\n        this._options = null;\n        this._sdkKey = null;\n        this._cacheLimit = CACHE_LIMIT;\n        this._lastModifiedStoreKey = `statsig.last_modified_time.${_cacheSuffix}`;\n        this._inMemoryCache = new InMemoryCache();\n    }\n    attach(sdkKey, options, _network) {\n        this._sdkKey = sdkKey;\n        this._options = options;\n    }\n    getDataSync(user) {\n        const normalized = user && (0, StatsigUser_1._normalizeUser)(user, this._options);\n        const cacheKey = this._getCacheKey(normalized);\n        const inMem = this._inMemoryCache.get(cacheKey, normalized);\n        if (inMem && this._getIsCacheValueValid(inMem)) {\n            return inMem;\n        }\n        const cache = this._loadFromCache(cacheKey);\n        if (cache && this._getIsCacheValueValid(cache)) {\n            this._inMemoryCache.add(cacheKey, cache, this._cacheLimit);\n            return this._inMemoryCache.get(cacheKey, normalized);\n        }\n        return null;\n    }\n    setData(data, user) {\n        const normalized = user && (0, StatsigUser_1._normalizeUser)(user, this._options);\n        const cacheKey = this._getCacheKey(normalized);\n        this._inMemoryCache.add(cacheKey, _makeDataAdapterResult('Bootstrap', data, null, normalized), this._cacheLimit);\n    }\n    _getIsCacheValueValid(current) {\n        return (current.stableID == null ||\n            current.stableID === StableID_1.StableID.get(this._getSdkKey()));\n    }\n    _getDataAsyncImpl(current, user, options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!StorageProvider_1.Storage.isReady()) {\n                yield StorageProvider_1.Storage.isReadyResolver();\n            }\n            const cache = current !== null && current !== void 0 ? current : this.getDataSync(user);\n            const ops = [this._fetchAndPrepFromNetwork(cache, user, options)];\n            if (options === null || options === void 0 ? void 0 : options.timeoutMs) {\n                ops.push(new Promise((r) => setTimeout(r, options.timeoutMs)).then(() => {\n                    Log_1.Log.debug('Fetching latest value timed out');\n                    return null;\n                }));\n            }\n            return yield Promise.race(ops);\n        });\n    }\n    _prefetchDataImpl(user, options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const normalized = user && (0, StatsigUser_1._normalizeUser)(user, this._options);\n            const cacheKey = this._getCacheKey(normalized);\n            const result = yield this._getDataAsyncImpl(null, normalized, options);\n            if (result) {\n                this._inMemoryCache.add(cacheKey, Object.assign(Object.assign({}, result), { source: 'Prefetch' }), this._cacheLimit);\n            }\n        });\n    }\n    _fetchAndPrepFromNetwork(cachedResult, user, options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            const cachedData = (_a = cachedResult === null || cachedResult === void 0 ? void 0 : cachedResult.data) !== null && _a !== void 0 ? _a : null;\n            const isCacheValidFor204 = cachedResult != null &&\n                this._isCachedResultValidFor204(cachedResult, user);\n            const latest = yield this._fetchFromNetwork(cachedData, user, options, isCacheValidFor204);\n            if (!latest) {\n                Log_1.Log.debug('No response returned for latest value');\n                return null;\n            }\n            const response = (0, TypedJsonParse_1._typedJsonParse)(latest, 'has_updates', 'Response');\n            const sdkKey = this._getSdkKey();\n            const stableID = StableID_1.StableID.get(sdkKey);\n            let result = null;\n            if ((response === null || response === void 0 ? void 0 : response.has_updates) === true) {\n                result = _makeDataAdapterResult('Network', latest, stableID, user);\n            }\n            else if (cachedData && (response === null || response === void 0 ? void 0 : response.has_updates) === false) {\n                result = _makeDataAdapterResult('NetworkNotModified', cachedData, stableID, user);\n            }\n            else {\n                return null;\n            }\n            const cacheKey = this._getCacheKey(user);\n            this._inMemoryCache.add(cacheKey, result, this._cacheLimit);\n            this._writeToCache(cacheKey, result);\n            return result;\n        });\n    }\n    _getSdkKey() {\n        if (this._sdkKey != null) {\n            return this._sdkKey;\n        }\n        Log_1.Log.error(`${this._adapterName} is not attached to a Client`);\n        return '';\n    }\n    _loadFromCache(cacheKey) {\n        var _a;\n        const cache = (_a = StorageProvider_1.Storage.getItem) === null || _a === void 0 ? void 0 : _a.call(StorageProvider_1.Storage, cacheKey);\n        if (cache == null) {\n            return null;\n        }\n        const result = (0, TypedJsonParse_1._typedJsonParse)(cache, 'source', 'Cached Result');\n        return result ? Object.assign(Object.assign({}, result), { source: 'Cache' }) : null;\n    }\n    _writeToCache(cacheKey, result) {\n        const resultString = JSON.stringify(result);\n        for (let i = 0; i < MAX_CACHE_WRITE_ATTEMPTS; i++) {\n            try {\n                StorageProvider_1.Storage.setItem(cacheKey, resultString);\n                break;\n            }\n            catch (error) {\n                if (!(error instanceof Error) ||\n                    !(error.toString().includes('QuotaExceededError') ||\n                        error.toString().includes('QUOTA_EXCEEDED_ERR')) ||\n                    this._cacheLimit <= 1) {\n                    throw error;\n                }\n                this._cacheLimit = Math.ceil(this._cacheLimit / 2);\n                this._runLocalStorageCacheEviction(cacheKey, this._cacheLimit - 1);\n            }\n        }\n        this._runLocalStorageCacheEviction(cacheKey);\n    }\n    _runLocalStorageCacheEviction(cacheKey, cacheLimit = this._cacheLimit) {\n        var _a;\n        const lastModifiedTimeMap = (_a = (0, StorageProvider_1._getObjectFromStorage)(this._lastModifiedStoreKey)) !== null && _a !== void 0 ? _a : {};\n        lastModifiedTimeMap[cacheKey] = Date.now();\n        const evictableKeys = _getEvictableKeys(lastModifiedTimeMap, cacheLimit);\n        for (const evictable of evictableKeys) {\n            delete lastModifiedTimeMap[evictable];\n            StorageProvider_1.Storage.removeItem(evictable);\n        }\n        (0, StorageProvider_1._setObjectInStorage)(this._lastModifiedStoreKey, lastModifiedTimeMap);\n    }\n}\nexports.DataAdapterCore = DataAdapterCore;\nfunction _makeDataAdapterResult(source, data, stableID, user) {\n    return {\n        source,\n        data,\n        receivedAt: Date.now(),\n        stableID,\n        fullUserHash: (0, StatsigUser_1._getFullUserHash)(user),\n    };\n}\nexports._makeDataAdapterResult = _makeDataAdapterResult;\nclass InMemoryCache {\n    constructor() {\n        this._data = {};\n    }\n    get(cacheKey, user) {\n        var _a;\n        const result = this._data[cacheKey];\n        const cached = result === null || result === void 0 ? void 0 : result.stableID;\n        const provided = (_a = user === null || user === void 0 ? void 0 : user.customIDs) === null || _a === void 0 ? void 0 : _a.stableID;\n        if (provided && cached && provided !== cached) {\n            Log_1.Log.warn(\"'StatsigUser.customIDs.stableID' mismatch\");\n            return null;\n        }\n        return result;\n    }\n    add(cacheKey, value, cacheLimit) {\n        const evictableKeys = _getEvictableKeys(this._data, cacheLimit - 1);\n        for (const evictable of evictableKeys) {\n            delete this._data[evictable];\n        }\n        this._data[cacheKey] = value;\n    }\n    merge(values) {\n        this._data = Object.assign(Object.assign({}, this._data), values);\n    }\n}\nfunction _getEvictableKeys(data, limit) {\n    const keys = Object.keys(data);\n    if (keys.length <= limit) {\n        return [];\n    }\n    if (limit === 0) {\n        return keys;\n    }\n    return keys\n        .sort((keyA, keyB) => {\n        const valueA = data[keyA];\n        const valueB = data[keyB];\n        if (typeof valueA === 'object' && typeof valueB === 'object') {\n            return valueA.receivedAt - valueB.receivedAt;\n        }\n        return valueA - valueB;\n    })\n        .slice(0, keys.length - limit);\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}