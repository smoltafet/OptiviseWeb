{"ast":null,"code":"\"use strict\";\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.StatsigEvaluationsDataAdapter = void 0;\nconst client_core_1 = require(\"@statsig/client-core\");\nconst Network_1 = require(\"./Network\");\nclass StatsigEvaluationsDataAdapter extends client_core_1.DataAdapterCore {\n  constructor() {\n    super('EvaluationsDataAdapter', 'evaluations');\n    this._network = null;\n    this._options = null;\n  }\n  attach(sdkKey, options, network) {\n    super.attach(sdkKey, options, network);\n    if (network !== null && network instanceof Network_1.default) {\n      this._network = network;\n    } else {\n      this._network = new Network_1.default(options !== null && options !== void 0 ? options : {});\n    }\n  }\n  getDataAsync(current, user, options) {\n    return this._getDataAsyncImpl(current, (0, client_core_1._normalizeUser)(user, this._options), options);\n  }\n  prefetchData(user, options) {\n    return this._prefetchDataImpl(user, options);\n  }\n  setData(data) {\n    const values = (0, client_core_1._typedJsonParse)(data, 'has_updates', 'data');\n    if (values && 'user' in values) {\n      super.setData(data, values.user);\n    } else {\n      client_core_1.Log.error('StatsigUser not found. You may be using an older server SDK version. Please upgrade your SDK or use setDataLegacy.');\n    }\n  }\n  setDataLegacy(data, user) {\n    super.setData(data, user);\n  }\n  _fetchFromNetwork(current, user, options, isCacheValidFor204) {\n    return __awaiter(this, void 0, void 0, function* () {\n      var _a;\n      const result = yield (_a = this._network) === null || _a === void 0 ? void 0 : _a.fetchEvaluations(this._getSdkKey(), current, options === null || options === void 0 ? void 0 : options.priority, user, isCacheValidFor204);\n      return result !== null && result !== void 0 ? result : null;\n    });\n  }\n  _getCacheKey(user) {\n    var _a;\n    const key = (0, client_core_1._getStorageKey)(this._getSdkKey(), user, (_a = this._options) === null || _a === void 0 ? void 0 : _a.customUserCacheKeyFunc);\n    return `${client_core_1.DataAdapterCachePrefix}.${this._cacheSuffix}.${key}`;\n  }\n  _isCachedResultValidFor204(result, user) {\n    return result.fullUserHash != null && result.fullUserHash === (0, client_core_1._getFullUserHash)(user);\n  }\n}\nexports.StatsigEvaluationsDataAdapter = StatsigEvaluationsDataAdapter;","map":{"version":3,"names":["__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","Object","defineProperty","exports","StatsigEvaluationsDataAdapter","client_core_1","require","Network_1","DataAdapterCore","constructor","_network","_options","attach","sdkKey","options","network","default","getDataAsync","current","user","_getDataAsyncImpl","_normalizeUser","prefetchData","_prefetchDataImpl","setData","data","values","_typedJsonParse","Log","error","setDataLegacy","_fetchFromNetwork","isCacheValidFor204","_a","fetchEvaluations","_getSdkKey","priority","_getCacheKey","key","_getStorageKey","customUserCacheKeyFunc","DataAdapterCachePrefix","_cacheSuffix","_isCachedResultValidFor204","fullUserHash","_getFullUserHash"],"sources":["/Users/sidiq/Documents/OptiviseWeb/node_modules/@statsig/js-client/src/StatsigEvaluationsDataAdapter.js"],"sourcesContent":["\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.StatsigEvaluationsDataAdapter = void 0;\nconst client_core_1 = require(\"@statsig/client-core\");\nconst Network_1 = require(\"./Network\");\nclass StatsigEvaluationsDataAdapter extends client_core_1.DataAdapterCore {\n    constructor() {\n        super('EvaluationsDataAdapter', 'evaluations');\n        this._network = null;\n        this._options = null;\n    }\n    attach(sdkKey, options, network) {\n        super.attach(sdkKey, options, network);\n        if (network !== null && network instanceof Network_1.default) {\n            this._network = network;\n        }\n        else {\n            this._network = new Network_1.default(options !== null && options !== void 0 ? options : {});\n        }\n    }\n    getDataAsync(current, user, options) {\n        return this._getDataAsyncImpl(current, (0, client_core_1._normalizeUser)(user, this._options), options);\n    }\n    prefetchData(user, options) {\n        return this._prefetchDataImpl(user, options);\n    }\n    setData(data) {\n        const values = (0, client_core_1._typedJsonParse)(data, 'has_updates', 'data');\n        if (values && 'user' in values) {\n            super.setData(data, values.user);\n        }\n        else {\n            client_core_1.Log.error('StatsigUser not found. You may be using an older server SDK version. Please upgrade your SDK or use setDataLegacy.');\n        }\n    }\n    setDataLegacy(data, user) {\n        super.setData(data, user);\n    }\n    _fetchFromNetwork(current, user, options, isCacheValidFor204) {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            const result = yield ((_a = this._network) === null || _a === void 0 ? void 0 : _a.fetchEvaluations(this._getSdkKey(), current, options === null || options === void 0 ? void 0 : options.priority, user, isCacheValidFor204));\n            return result !== null && result !== void 0 ? result : null;\n        });\n    }\n    _getCacheKey(user) {\n        var _a;\n        const key = (0, client_core_1._getStorageKey)(this._getSdkKey(), user, (_a = this._options) === null || _a === void 0 ? void 0 : _a.customUserCacheKeyFunc);\n        return `${client_core_1.DataAdapterCachePrefix}.${this._cacheSuffix}.${key}`;\n    }\n    _isCachedResultValidFor204(result, user) {\n        return (result.fullUserHash != null &&\n            result.fullUserHash === (0, client_core_1._getFullUserHash)(user));\n    }\n}\nexports.StatsigEvaluationsDataAdapter = StatsigEvaluationsDataAdapter;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}