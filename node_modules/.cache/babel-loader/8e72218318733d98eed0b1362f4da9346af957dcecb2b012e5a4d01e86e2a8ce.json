{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Diagnostics = void 0;\nconst MARKER_MAP = new Map();\nconst ACT_START = 'start';\nconst ACT_END = 'end';\nconst DIAGNOSTICS_EVENT = 'statsig::diagnostics';\nexports.Diagnostics = {\n  _getMarkers: sdkKey => {\n    return MARKER_MAP.get(sdkKey);\n  },\n  _markInitOverallStart: sdkKey => {\n    _addMarker(sdkKey, _createMarker({}, ACT_START, 'overall'));\n  },\n  _markInitOverallEnd: (sdkKey, success, evaluationDetails) => {\n    _addMarker(sdkKey, _createMarker({\n      success,\n      error: success ? undefined : {\n        name: 'InitializeError',\n        message: 'Failed to initialize'\n      },\n      evaluationDetails\n    }, ACT_END, 'overall'));\n  },\n  _markInitNetworkReqStart: (sdkKey, data) => {\n    _addMarker(sdkKey, _createMarker(data, ACT_START, 'initialize', 'network_request'));\n  },\n  _markInitNetworkReqEnd: (sdkKey, data) => {\n    _addMarker(sdkKey, _createMarker(data, ACT_END, 'initialize', 'network_request'));\n  },\n  _markInitProcessStart: sdkKey => {\n    _addMarker(sdkKey, _createMarker({}, ACT_START, 'initialize', 'process'));\n  },\n  _markInitProcessEnd: (sdkKey, data) => {\n    _addMarker(sdkKey, _createMarker(data, ACT_END, 'initialize', 'process'));\n  },\n  _clearMarkers: sdkKey => {\n    MARKER_MAP.delete(sdkKey);\n  },\n  _formatError(e) {\n    if (!(e && typeof e === 'object')) {\n      return;\n    }\n    return {\n      code: _safeGetField(e, 'code'),\n      name: _safeGetField(e, 'name'),\n      message: _safeGetField(e, 'message')\n    };\n  },\n  _getDiagnosticsData(res, attempt, body, e) {\n    var _a;\n    return {\n      success: (res === null || res === void 0 ? void 0 : res.ok) === true,\n      statusCode: res === null || res === void 0 ? void 0 : res.status,\n      sdkRegion: (_a = res === null || res === void 0 ? void 0 : res.headers) === null || _a === void 0 ? void 0 : _a.get('x-statsig-region'),\n      isDelta: body.includes('\"is_delta\":true') === true ? true : undefined,\n      attempt,\n      error: exports.Diagnostics._formatError(e)\n    };\n  },\n  _enqueueDiagnosticsEvent(user, logger, sdk, options) {\n    const markers = exports.Diagnostics._getMarkers(sdk);\n    if (markers == null || markers.length <= 0) {\n      return -1;\n    }\n    const overallInitDuration = markers[markers.length - 1].timestamp - markers[0].timestamp;\n    exports.Diagnostics._clearMarkers(sdk);\n    const event = _makeDiagnosticsEvent(user, {\n      context: 'initialize',\n      markers: markers.slice(),\n      statsigOptions: options\n    });\n    logger.enqueue(event);\n    return overallInitDuration;\n  }\n};\nfunction _createMarker(data, action, key, step) {\n  return Object.assign({\n    key: key,\n    action: action,\n    step: step,\n    timestamp: Date.now()\n  }, data);\n}\nfunction _makeDiagnosticsEvent(user, data) {\n  const latencyEvent = {\n    eventName: DIAGNOSTICS_EVENT,\n    user,\n    value: null,\n    metadata: data,\n    time: Date.now()\n  };\n  return latencyEvent;\n}\nfunction _addMarker(sdkKey, marker) {\n  var _a;\n  const markers = (_a = MARKER_MAP.get(sdkKey)) !== null && _a !== void 0 ? _a : [];\n  markers.push(marker);\n  MARKER_MAP.set(sdkKey, markers);\n}\nfunction _safeGetField(data, field) {\n  if (field in data) {\n    return data[field];\n  }\n  return undefined;\n}","map":{"version":3,"names":["Object","defineProperty","exports","value","Diagnostics","MARKER_MAP","Map","ACT_START","ACT_END","DIAGNOSTICS_EVENT","_getMarkers","sdkKey","get","_markInitOverallStart","_addMarker","_createMarker","_markInitOverallEnd","success","evaluationDetails","error","undefined","name","message","_markInitNetworkReqStart","data","_markInitNetworkReqEnd","_markInitProcessStart","_markInitProcessEnd","_clearMarkers","delete","_formatError","e","code","_safeGetField","_getDiagnosticsData","res","attempt","body","_a","ok","statusCode","status","sdkRegion","headers","isDelta","includes","_enqueueDiagnosticsEvent","user","logger","sdk","options","markers","length","overallInitDuration","timestamp","event","_makeDiagnosticsEvent","context","slice","statsigOptions","enqueue","action","key","step","assign","Date","now","latencyEvent","eventName","metadata","time","marker","push","set","field"],"sources":["/Users/sidiq/Documents/OptiviseWeb/node_modules/@statsig/client-core/src/Diagnostics.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Diagnostics = void 0;\nconst MARKER_MAP = new Map();\nconst ACT_START = 'start';\nconst ACT_END = 'end';\nconst DIAGNOSTICS_EVENT = 'statsig::diagnostics';\nexports.Diagnostics = {\n    _getMarkers: (sdkKey) => {\n        return MARKER_MAP.get(sdkKey);\n    },\n    _markInitOverallStart: (sdkKey) => {\n        _addMarker(sdkKey, _createMarker({}, ACT_START, 'overall'));\n    },\n    _markInitOverallEnd: (sdkKey, success, evaluationDetails) => {\n        _addMarker(sdkKey, _createMarker({\n            success,\n            error: success\n                ? undefined\n                : { name: 'InitializeError', message: 'Failed to initialize' },\n            evaluationDetails,\n        }, ACT_END, 'overall'));\n    },\n    _markInitNetworkReqStart: (sdkKey, data) => {\n        _addMarker(sdkKey, _createMarker(data, ACT_START, 'initialize', 'network_request'));\n    },\n    _markInitNetworkReqEnd: (sdkKey, data) => {\n        _addMarker(sdkKey, _createMarker(data, ACT_END, 'initialize', 'network_request'));\n    },\n    _markInitProcessStart: (sdkKey) => {\n        _addMarker(sdkKey, _createMarker({}, ACT_START, 'initialize', 'process'));\n    },\n    _markInitProcessEnd: (sdkKey, data) => {\n        _addMarker(sdkKey, _createMarker(data, ACT_END, 'initialize', 'process'));\n    },\n    _clearMarkers: (sdkKey) => {\n        MARKER_MAP.delete(sdkKey);\n    },\n    _formatError(e) {\n        if (!(e && typeof e === 'object')) {\n            return;\n        }\n        return {\n            code: _safeGetField(e, 'code'),\n            name: _safeGetField(e, 'name'),\n            message: _safeGetField(e, 'message'),\n        };\n    },\n    _getDiagnosticsData(res, attempt, body, e) {\n        var _a;\n        return {\n            success: (res === null || res === void 0 ? void 0 : res.ok) === true,\n            statusCode: res === null || res === void 0 ? void 0 : res.status,\n            sdkRegion: (_a = res === null || res === void 0 ? void 0 : res.headers) === null || _a === void 0 ? void 0 : _a.get('x-statsig-region'),\n            isDelta: body.includes('\"is_delta\":true') === true ? true : undefined,\n            attempt,\n            error: exports.Diagnostics._formatError(e),\n        };\n    },\n    _enqueueDiagnosticsEvent(user, logger, sdk, options) {\n        const markers = exports.Diagnostics._getMarkers(sdk);\n        if (markers == null || markers.length <= 0) {\n            return -1;\n        }\n        const overallInitDuration = markers[markers.length - 1].timestamp - markers[0].timestamp;\n        exports.Diagnostics._clearMarkers(sdk);\n        const event = _makeDiagnosticsEvent(user, {\n            context: 'initialize',\n            markers: markers.slice(),\n            statsigOptions: options,\n        });\n        logger.enqueue(event);\n        return overallInitDuration;\n    },\n};\nfunction _createMarker(data, action, key, step) {\n    return Object.assign({ key: key, action: action, step: step, timestamp: Date.now() }, data);\n}\nfunction _makeDiagnosticsEvent(user, data) {\n    const latencyEvent = {\n        eventName: DIAGNOSTICS_EVENT,\n        user,\n        value: null,\n        metadata: data,\n        time: Date.now(),\n    };\n    return latencyEvent;\n}\nfunction _addMarker(sdkKey, marker) {\n    var _a;\n    const markers = (_a = MARKER_MAP.get(sdkKey)) !== null && _a !== void 0 ? _a : [];\n    markers.push(marker);\n    MARKER_MAP.set(sdkKey, markers);\n}\nfunction _safeGetField(data, field) {\n    if (field in data) {\n        return data[field];\n    }\n    return undefined;\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}